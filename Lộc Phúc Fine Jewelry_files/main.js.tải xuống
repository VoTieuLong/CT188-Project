(function ($) {
    "use strict";
    if (pageCurrentt != null) {
        var $parent = $("a.product-page").closest(".pagination-box");
        var $li = $parent.find("li");
        var length = $li.length;

        var indexActive = parseInt(pageCurrentt);

        $li.removeClass("active");
        $li.eq(indexActive).addClass("active");

        // Show nút previous
        if (indexActive > 1) {
            $parent.find("li:first").show();
        }
        // Show nút next
        if (indexActive + 2 <= length) {
            $parent.find("li:last").show();
        }
        // Trang cuối thì ẩn nút đi
        if (indexActive == 1) {
            $parent.find("li:first").hide();
        }
        // Trang cuối thì ẩn nút đi
        if (length - indexActive < 3) {
            $parent.find("li:last").hide();
        }

        // Hiển thị số trang +-2 với li đang active

        var routingProductPage = $("li.active").find('a.product-page').attr("href");
        if (routingProductPage != undefined) {
            // Bộ lọc cho sản phẩm khác với bộ lọc cho kim cương rời nên dùng class để phân biệt
            var isDiamond = $("a.product-page").closest(".paginatoin-area").hasClass("diamond-filter");
            var isProductSearch = $("a.product-page").closest(".paginatoin-area").hasClass("product-search");
            if (isDiamond) {
                getDiamond(null, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive, true);
            } else if (isProductSearch) {
                var name = $("a.product-page").closest(".paginatoin-area.product-search").attr("data-search");
                getProductsSearch(name, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive);
            } else {
                showPageNumbers($parent, $li, length, indexActive);
                if (window.innerWidth < 992) {
                    getProductsMobile(routingProductPage)
                } else {

                    getProducts(routingProductPage);
                }
            }
        }
    }

    



    
    
    $("#infor-shipping").on("change", "select[name='City']", function () {
        //alert("Chagnge");
        var cityId = $("#CityId").val();
        $("input[name='City']").val(cityId);
        $("select[name='Province']").removeAttr("disabled");
        $.ajax({
            url: "/Get-Province",
            type: "GET",
            data: { cityId: cityId },
            success: function (data) {
                var ddldist = $('#ProvinceId');
                $("#ProvinceId option").remove();
                $("#select2-chosen-2").text("Vui lòng chọn ...");
                $("input[name='Province']").val("");
                $("input[name='Ward']").val("");
                $.each(data, function (val, text) {
                    ddldist.append(
                        $('<option></option>').val(text.Id).html(text.ProvinceName)
                    );
                });
            }
        });
    })

    $("#infor-shipping").on("change", "select[name='Province']", function () {
        //$("form").submit();
        var provinceId = $("#ProvinceId").val();
        $("input[name='Province']").val(provinceId);
        $("select[name='Ward']").removeAttr("disabled");
        $.ajax({
            url: "/Get-Ward",
            type: "GET",
            data: { provinceId: provinceId },
            success: function (data) {
                var ddldist = $('#WardId');
                $("#WardId option").remove();
                $("#select2-chosen-3").text("Vui lòng chọn ...");
                $("input[name='Ward']").val("");
                $.each(data, function (val, text) {
                    ddldist.append(
                        $('<option></option>').val(text.Id).html(text.WardName)
                    );
                });
            }
        });
    })

    $("#infor-shipping").on("click", ".fa.fa-pencil", function () {
        //alert("CLICK");
        var deliveryId = $(this).attr("data-id");
        $.ajax({
            url: "/sua-dia-chi-giao-hang",
            type: "GET",
            data: { deliveryId: deliveryId },
            success: function (data) {
                $("#infor-shipping").html(data);

                $("#CityId").select2();
                $("#ProvinceId").select2();
                $("#WardId").select2();
                // Bỏ position: relative của body để select 2 đúng vị trí
                $("body").css("position", "inherit");
            }
        });
        console.log(deliveryId);
    })

    // Sticky menu
    var $window = $(window);
    $window.on('scroll', function () {
        var scroll = $window.scrollTop();
        if (scroll < 200) {
            $(".sticky").removeClass("is-sticky");
        } else {
            $(".sticky").addClass("is-sticky");
        }
    });

    //Range filter
    // tooltip active js
    $(document).ready(function () {
        $("select:not(#barrating):not(#barrating-quickview):not(#barrating-quickview-diamond)").niceSelect();

        let currentObject;
        let oClosestForm;
        let oInputRouting;
        let objectEvent = document.querySelectorAll('form .cart-hover-x');
        let i;
        for (i = 0; i < objectEvent.length; i++) {
            objectEvent[i].onclick = function () {
                currentObject = this;
                oClosestForm = currentObject.closest("form");
                oInputRouting = oClosestForm.querySelector("form #routing");
                //console.log(oInput.value);
                document.location.href = oInputRouting.value;
            }
        };

        //$('.submit-promotion').on("click", function () {
        //    //alert("PRomotion");
        //    let closeDOM = this.closest('.row');
        //    console.log(closeDOM)
        //})
    });


    $(document).ready(function () {
        //Load thông tin nếu đăng nhập ở trang đặt hàng
        var cityName = document.querySelector('input[name="ReceiverCityName"]');
        var selectCity = document.querySelector('.single-input-item div.ReceiverCity-select');
        cityName != undefined ? cityName.value != "" ? selectCity.querySelector('.current').innerHTML = cityName.value : undefined : undefined;

        var provinceName = document.querySelector('input[name="ReceiverProvinceName"]');
        var selectProvince = document.querySelector('.single-input-item div.ReceiverProvince-select');
        provinceName != undefined ? provinceName.value != "" ? selectProvince.querySelector('.current').innerHTML = provinceName.value : undefined : undefined;


        var wardName = document.querySelector('input[name="ReceiverWardName"]');
        var selectWard = document.querySelector('.single-input-item div.ReceiverWard-select');
        wardName != undefined ? wardName.value != "" ? selectWard.querySelector('.current').innerHTML = wardName.value : undefined : undefined;
        //var selectCity = document.querySelector('.single-input-item div.ReceiverCity-select');
        //var test = selectCity.querySelector('.current');
        //console.log(test);
    })


    $('[data-toggle="tooltip"]').tooltip();
    //var oDropRight = document.getElementsByClassName('dropright')[0];
    //let DropDownShow = false;
    //let oDropRight = document.getElementById('user-login-mobile');
    //oDropRight.onclick = function () {
    //    let oDropdonwMenu = document.querySelector('#dropdown-menu-right');
    //    console.log(oDropdonwMenu);
    //    //alert("YES");
    //    if (DropDownShow == false) {
    //        //oDropdowMenu = 
    //        oDropdonwMenu.classList.add("show");
    //        DropDownShow = true;
    //    }
    //    else {
    //        oDropdonwMenu.classList.remove("show");
    //        DropDownShow = false;
    //    }
    //}

    // tooltip active js
    //$('[data-toggle="tooltip"]').tooltip();


    // Background Image JS start
    var bgSelector = $(".bg-img");
    bgSelector.each(function (index, elem) {
        var element = $(elem),
            bgSource = element.data('bg');
        element.css('background-image', 'url(' + bgSource + ')');
    });



    // Off Canvas Open close
    $(".mobile-menu-btn").on('click', function () {
        $("body").addClass('fix');
        $(".off-canvas-wrapper").addClass('open');
    });

    $(".btn-close-off-canvas,.off-canvas-overlay").on('click', function () {
        $("body").removeClass('fix');
        $(".off-canvas-wrapper").removeClass('open');
    });

    // offcanvas mobile menu
    var $offCanvasNav = $('.mobile-menu'),
        $offCanvasNavSubMenu = $offCanvasNav.find('.dropdown');

    /*Add Toggle Button With Off Canvas Sub Menu*/
    $offCanvasNavSubMenu.parent().prepend('<span class="menu-expand"><i></i></span>');

    /*Close Off Canvas Sub Menu*/
    $offCanvasNavSubMenu.slideUp();

    /*Category Sub Menu Toggle*/
    $offCanvasNav.on('click', 'li a, li .menu-expand', function (e) {
        var $this = $(this);
        if (($this.parent().attr('class').match(/\b(menu-item-has-children|has-children|has-sub-menu)\b/)) && ($this.attr('href') === '#' || $this.hasClass('menu-expand'))) {
            e.preventDefault();
            if ($this.siblings('ul:visible').length) {
                $this.parent('li').removeClass('active');
                $this.siblings('ul').slideUp();
            } else {
                $this.parent('li').addClass('active');
                $this.closest('li').siblings('li').removeClass('active').find('li').removeClass('active');
                $this.closest('li').siblings('li').find('ul:visible').slideUp();
                $this.siblings('ul').slideDown();
            }
        }
    });

    //product carousel active js
    $('.product-carousel-4_55').slick({
        speed: 300,
        slidesToShow: 7,
        autoplay: true,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 5
            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 4,
                arrows: false
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 3,
                arrows: false
            }
        }]
    });


    $('.product-carousel-4_66').slick({
        speed: 300,
        slidesToShow: 6,
        autoplay: true,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 5
            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 4,
                arrows: false
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 3,
                arrows: false
            }
        }]
    });
    // hero slider active js
    $('.hero-slider-active').slick({
        fade: true,
        speed: 600,
        dots: false,
        autoplay: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                arrows: true,
                dots: false
            }
        }]
    });


    // product carousel active js
    $('.product-carousel-4').slick({
        speed: 300,
        slidesToShow: 4,
        autoplay: true,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 3
            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 2,
                arrows: false
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 2,
                arrows: false
            }
        }]
    });


    // product carousel active
    $('.product-carousel-4_2').slick({
        speed: 300,
        //lazyLoad: 'ondemand',
        slidesToShow: 4,
        autoplay: false,
        rows: 2,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',

        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 3

            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 2,
                arrows: false,
                rows: 2
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 2,
                arrows: false,
                rows: 2
            }
        }]
    });
    $('.product-carousel-4_2_relate').slick({
        speed: 300,
        //lazyLoad: 'ondemand',
        slidesToShow: 4,
        autoplay: false,
        rows: 2,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',

        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 3

            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 2,
                arrows: false,
                rows: 2
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 2,
                arrows: false,
                rows: 2
            }
        }]
    });

    // product carousel active2
    $('.product-carousel-2_2').slick({
        speed: 300,
        slidesToShow: 2,
        autoplay: false,
        rows: 2,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 2,
                arrows: true,

            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 2,
                arrows: true,
                rows: 2
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 2,
                arrows: true,
                rows: 2
            }
        }]
    });

    // product banner active js
    $('.product-banner-carousel').slick({
        autoplay: true,
        speed: 300,
        arrows: false,
        slidesToShow: 5,
        adaptiveHeight: true,
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 3
            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 2
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 1
            }
        }]
    });


    // group product carousel active
    $('.group-list-carousel').each(function () {
        var $this = $(this);
        var $arrowContainer = $(this).parent().siblings('.section-title-append').find('.slick-append');
        $this.slick({
            infinite: true,
            rows: 5,
            prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
            nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
            appendArrows: $arrowContainer,
            responsive: [{
                breakpoint: 992,
                settings: {
                    slidesToShow: 2,
                }
            },
            {
                breakpoint: 768,
                settings: {
                    slidesToShow: 1,
                }
            }]
        });
    });


    // blog carousel active start
    $('.group-list-carousel--3').slick({
        autoplay: true,
        speed: 300,
        rows: 3,
        slidesToShow: 3,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 2
            }
        },
        {
            breakpoint: 768,
            settings: {
                arrows: false,
                slidesToShow: 1
            }
        }]
    });

    // blog carousel active start
    $('.blog-carousel-2').slick({
        speed: 300,
        dots: true,
        arrows: false
    });


    // testimonial cariusel active js
    $('.testimonial-content-carousel').slick({
        arrows: false,
        asNavFor: '.testimonial-thumb-carousel'
    });


    // product details slider nav active
    $('.testimonial-thumb-carousel').slick({
        slidesToShow: 3,
        asNavFor: '.testimonial-content-carousel',
        centerMode: true,
        arrows: false,
        centerPadding: 0,
        focusOnSelect: true
    });


    // blog carousel active
    $('.blog-carousel-active').slick({
        autoplay: true,
        speed: 300,
        slidesToShow: 3,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 2
            }
        },
        {
            breakpoint: 768,
            settings: {
                arrows: false,
                slidesToShow: 1
            }
        }]
    });
    $('.blog-carousel2-active').slick({
        autoplay: true,
        speed: 300,
        slidesToShow: 4,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 2
            }
        },
        {
            breakpoint: 768,
            settings: {
                arrows: false,
                slidesToShow: 2
            }
        }]
    });

    //  Hot deals carousel active start
    $('.deals-carousel-active').slick({
        autoplay: true,
        speed: 300,
        slidesToShow: 3,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 2
            }
        },
        {
            breakpoint: 768,
            settings: {
                arrows: false,
                slidesToShow: 2
            }
        },
        {
            breakpoint: 576,
            settings: {
                arrows: false,
                slidesToShow: 1
            }
        }]
    });


    // brand logo carousel active js
    $('.brand-logo-carousel').slick({
        speed: 300,
        slidesToShow: 5,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 1200,
            settings: {
                slidesToShow: 4
            }
        },
        {
            breakpoint: 992,
            settings: {
                slidesToShow: 3,
                arrows: false
            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 2,
                arrows: false
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 1,
                arrows: false
            }
        }]
    });


    // prodct details slider active
    $('.product-large-slider').slick({
        speed: 300,
        fade: true,
        arrows: false,
        asNavFor: '.pro-nav.nav-product'
    });


    // product details slider nav active
    $('.pro-nav.nav-product').slick({

        slidesToShow: 5,
        asNavFor: '.product-large-slider',

        centerPadding: 0,
        focusOnSelect: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
        responsive: [{
            breakpoint: 576,
            settings: {
                slidesToShow: 3,
            }
        }]
    });
    $('#play').on('click', function (e) {
        e.preventDefault();
        const playerElem = $("#player");

        playerElem.parent().css('height', '100%');
        playerElem[0].contentWindow.location.reload(true);
        playerElem.show();

        $('#video-cover').hide();
        $('#play').show();
    })

    // Nice select active start
    //$('select').niceSelect();

    // Image zoom effect
    $('.img-zoom').zoom(
        {
            magnify: 0.4
        });


    // offcanvas minicart button js
    $(".minicart-btn").on('click', function () {
        $("body").addClass('fix');
        $(".minicart-inner").addClass('show')
    })

    $(".offcanvas-close, .minicart-close,.offcanvas-overlay").on('click', function () {
        $("body").removeClass('fix');
        $(".minicart-inner").removeClass('show')
    })

    // offcanvas miniview button js
    $(".miniview-btn").on('click', function () {
        $("body").addClass('fix');
        $(".miniview-inner").addClass('show')
    })

    $(".offview-close, .miniview-close,.offview-overlay").on('click', function () {
        $("body").removeClass('fix');
        $(".miniview-inner").removeClass('show')
    })

    // Data countdown active js
    //$('[data-countdown]').each(function () {
    //    var $this = $(this),
    //    finalDate = $(this).data('countdown');
    //    activeCountdown($this, finalDate);

    //    $this.countdown(finalDate, function (event) {
    //        $this.html(event.strftime('<div class="single-countdown"><span class="single-countdown__time">%D</span><span class="single-countdown__text">Ngày</span></div><div class="single-countdown"><span class="single-countdown__time">%H</span><span class="single-countdown__text">Giờ</span></div><div class="single-countdown"><span class="single-countdown__time">%M</span><span class="single-countdown__text">Phút</span></div><div class="single-countdown"><span class="single-countdown__time">%S</span><span class="single-countdown__text">Giây</span></div>'));
    //    });
    //});
    activeCountdown($("#product-detail .product-details-des [data-countdown]"), $("#product-detail .product-details-des [data-countdown]").data('countdown'));
    function activeCountdown($this, finalDate) {
        setInterval(function () {
            var countDownDate = new Date(finalDate).getTime();
            // Get today's date and time
            var now = new Date().getTime();
            // Find the distance between now and the count down date
            var distance = countDownDate - now;

            // Time calculations for days, hours, minutes and seconds
            var days = Math.floor(distance / (1000 * 60 * 60 * 24));
            var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);
            $this.html(`<div class="single-countdown"><span class="single-countdown__time">${days}</span><span class="single-countdown__text">Ngày</span></div><div class="single-countdown"><span class="single-countdown__time">${hours}</span><span class="single-countdown__text">Giờ</span></div><div class="single-countdown"><span class="single-countdown__time">${minutes}</span><span class="single-countdown__text">Phút</span></div><div class="single-countdown"><span class="single-countdown__time">${seconds}</span><span class="single-countdown__text">Giây</span></div>`);

            // If the count down is over, write some text 
            if (distance < 0) {

                $this.html(`<div class="single-countdown"><span class="single-countdown__time">00</span><span class="single-countdown__text">Ngày</span></div><div class="single-countdown"><span class="single-countdown__time">00</span><span class="single-countdown__text">Giờ</span></div><div class="single-countdown"><span class="single-countdown__time">00</span><span class="single-countdown__text">Phút</span></div><div class="single-countdown"><span class="single-countdown__time">00</span><span class="single-countdown__text">Giây</span></div>`);
            }
        }, 1000);
    }


    // quantity change js
    $('.pro-qty').prepend('<span class="dec qtybtn">-</span>');
    $('.pro-qty').append('<span class="inc qtybtn">+</span>');
    $('.qtybtn').on('click', function () {
        var $button = $(this);
        var oldValue = $button.parent().find('input').val();
        if ($button.hasClass('inc')) {
            var newVal = parseFloat(oldValue) + 1;
        } else {
            // Don't allow decrementing below zero
            if (oldValue > 1) {
                var newVal = parseFloat(oldValue) - 1;
            } else {
                newVal = 1;
            }
        }
        $button.parent().find('input').val(newVal);
    });


    // product view mode change js
    $('.product-view-mode a').on('click', function (e) {
        e.preventDefault();
        var shopProductWrap = $('.shop-product-wrap');
        var viewMode = $(this).data('target');
        $('.product-view-mode a').removeClass('active');
        $(this).addClass('active');
        shopProductWrap.removeClass('grid-view list-view').addClass(viewMode);
    })


    // pricing filter
    var rangeSlider = $(".price-range"),
        amount = $("#amount"),
        minPrice = rangeSlider.data('min'),
        maxPrice = rangeSlider.data('max');
    rangeSlider.slider({
        range: true,
        min: minPrice,
        max: maxPrice,
        values: [minPrice, maxPrice],
        slide: function (event, ui) {
            amount.val("$" + ui.values[0] + " - $" + ui.values[1]);
        }
    });
    amount.val(" $" + rangeSlider.slider("values", 0) +
        " - $" + rangeSlider.slider("values", 1)
    );


    // Checkout Page accordion
    $("#create_pwd").on("change", function () {
        $(".account-create").slideToggle("100");
    });

    $("#ship_to_different").on("change", function () {
        $(".ship-to-different").slideToggle("100");
    });


    // Payment Method Accordion
    $('input[name="paymentmethod"]').on('click', function () {
        document.querySelectorAll('.international').forEach(function (item) {
            item.style.outline = "none";
        })
        document.querySelectorAll('.interior').forEach(function (item) {
            item.style.outline = "none";
        })
        var $value = $(this).attr('value');
        $('.payment-method-details').slideUp();
        $('[data-method="' + $value + '"]').slideDown();
    });


    // Scroll to top active js
    //$(window).on('scroll', function () {
    //    if ($(this).scrollTop() > 600) {
    //        $('.scroll-top').removeClass('not-visible');
    //    } else {
    //        $('.scroll-top').addClass('not-visible');
    //    }
    //});
    $('.scroll-top').on('click', function (event) {
        $('html,body').animate({
            scrollTop: 0
        }, 1000);
    });


    // Search trigger js
    $(".search-trigger").on('click', function () {
        $(".header-search-box").toggleClass('search-box-open');
    })


    // Mailchimp for dynamic newsletter
    //$('#mc-form').ajaxChimp({
    //    language: 'en',
    //    callback: mailChimpResponse,        
    //    url: 'https://devitems.us11.list-manage.com/subscribe/post?u=6bbb9b6f5827bd842d9640c82&amp;id=05d85f18ef'

    //});

    // mailchimp active js
    //function mailChimpResponse(resp) {
    //    if (resp.result === 'success') {
    //        $('.mailchimp-success').html('' + resp.msg).fadeIn(900);
    //        $('.mailchimp-error').fadeOut(400);

    //    } else if (resp.result === 'error') {
    //        $('.mailchimp-error').html('' + resp.msg).fadeIn(900);
    //    }
    //}

    // User Changeable Access
    //var activeId = $("#instafeed"),
    //    myTemplate = '<div class="instagram-item"><a href="{{link}}" target="_blank" id="{{id}}"><img src="{{image}}" /></a><div class="instagram-hvr-content"><span class="tottallikes"><i class="fa fa-heart"></i>{{likes}}</span><span class="totalcomments"><i class="fa fa-comments"></i>{{comments}}</span></div></div>';

    //if (activeId.length) {
    //    var userID = activeId.attr('data-userid'),
    //        accessTokenID = activeId.attr('data-accesstoken'),

    //        userFeed = new Instafeed({
    //            get: 'user',
    //            userId: userID,
    //            accessToken: accessTokenID,
    //            resolution: 'standard_resolution',
    //            template: myTemplate,
    //            sortBy: 'least-recent',
    //            limit: 15,
    //            links: false
    //        });
    //    userFeed.run();
    //}

    // Instagram feed carousel active
    $(window).on('load', function () {
        var instagramFeed = $(".instagram-carousel");
        instagramFeed.imagesLoaded(function () {
            instagramFeed.slick({
                slidesToShow: 5,
                slidesToScroll: 2,
                dots: false,
                arrows: false,
                responsive: [{
                    breakpoint: 480,
                    settings: {
                        slidesToShow: 2,
                    }
                },
                {
                    breakpoint: 767,
                    settings: {
                        slidesToShow: 3,
                    }
                },
                {
                    breakpoint: 991,
                    settings: {
                        slidesToShow: 4,
                    }
                }
                ]
            })
        });
    })


    //var urlDemo = "/locphucv3.test";
    //var urlDemo = "";

    // Cập nhật giỏ hàng
    $(".cart-update-option #updatecart").on("click", function () {

        let arrayItemCart = [];
        let quantityCart = 0;

        var $this = $(this).closest(".cart-main-wrapper.section-padding").find(".cart-table > table > tbody > tr");
        $this.each(function (index, element) {
            let quantity = $(element).find(".pro-qty input").val();
            quantityCart += parseInt(quantity);
            let id = $(element).find(".pro-qty input").attr("id");
            let note = $(element).find(".pro-note textarea").val();
            arrayItemCart.push({ id: id, quantity: quantity, notes: note });

        })

        $.ajax({
            url: urlDemo + "/cap-nhat-so-luong",
            type: "POST",
            data: { arrayItemCart: JSON.stringify(arrayItemCart) },
            success: function (response) {
                //if (response == "True") {
                //    $("#cartcount").text(quantityCart);
                //}
                window.location.href = urlDemo + '/gio-hang';
            }
        });

    })


    // delete item
    $(".offcanvas-minicart-wrapper .minicart-inner-content .minicart-item .minicart-remove").on("click", function (event) {

        // get item id    

        var itemId = $(this).closest(".minicart-item").find("input[name='id']").val();
        // submit to server

        var options = {
            url: urlDemo + "/xoa-don-hang",
            type: "POST",
            data: { id: itemId }
        };

        // CQRS: fire and forget call
        $.ajax(options).done(function () {
            location.reload()
        });

    });


    $(".remove-item-cart").on("click", function (event) {

        // get item id        
        var itemId = $(this).closest("tr").find(".pro-qty input[name='QuantityArray']").attr("id");
        var quantity = $(this).closest("tr").find(".pro-qty input[name='QuantityArray']").val();
        //var itemId = $(this).next()[0][0].defaultValue;


        // submit to server
        $("#idProduct").val();
        $("#quantity").val(0);


        var options = {
            //test
            //url: "/LocPhucJSCDemo/xoa-don-hang",
            url: urlDemo + "/xoa-don-hang",
            type: "POST",
            data: { id: itemId }
        };

        // CQRS: fire and forget call
        $.ajax(options).done(function () {
            var quantityCart = $("#cartcount").text();
            $("#cartcount").text(quantityCart - quantity);
            //$("#item-count").html(sQuantityinCart);

            $("#col-" + itemId).empty();

            $(`.minicart-inner-content .minicart-item input[value="${itemId}"]`).parent().remove();
            if ($("#cartcount").text() == 0) {
                $(".cart-main-wrapper.section-padding").css({ "padding": "0", "margin": "80px 0" })
                $(".cart-main-wrapper.section-padding .container").html();
                $(".cart-main-wrapper.section-padding .container").html(`<i class='fa fa-check' aria-hidden='true'></i> &nbsp; <span id='item-count'></span> Chưa có sản phẩm được thêm vào giỏ hàng.Nhấn vào <a href='/${urlDemo}'>đây</a > để tiếp tục mua hàng.`);
                //$("#item-count").empty();
                //$("#empty-item").html("<i class='fa fa-check' aria-hidden='true'></i> &nbsp; <span id='item-count'></span> Chưa có sản phẩm được thêm vào giỏ hàng.");
            }
        });

    });





    //
    Patterns.namespace("Product").Product = (function () {
        var utils = Patterns.Product.Utils;
        var app = Patterns.Product.App;
        $("select[name='OrderSummaryTable.customerInfo.CityId']").on("change", function () {
            var cityId = $("#CityId").val();
            var oHiddenCityName = document.querySelector("input[name='CityName']");
            oHiddenCityName.value = document.getElementById('select2-chosen-1').innerText;
            $("input[name='CityId']").val(cityId);
            $("select[name='OrderSummaryTable.customerInfo.ProvinceId']").removeAttr("disabled");
            //$("select[name='OrderSummaryTable.customerInfo.ProvinceId'] + .nice-select.from-control-custom.disabled").removeClass("disabled");
            $.ajax({
                //test
                //url: "/LocPhucJSCDemo/Get-Province",

                url: urlDemo + "/Get-Province",
                type: "GET",
                data: {
                    cityId: cityId
                },
                success: function (data) {
                    var ddldist = $('#ProvinceId');
                    $("#ProvinceId option").remove();
                    $.each(data, function (val, text) {
                        ddldist.append($('<option></option>').val(text.Id).html(text.ProvinceName))
                    })
                }
            })
        });
        $("select[name='OrderSummaryTable.customerInfo.ProvinceId']").on("change", function () {
            var provinceId = $("#ProvinceId").val();
            var oHiddenProvinceName = document.querySelector("input[name='ProvinceName']");
            oHiddenProvinceName.value = document.getElementById('select2-chosen-2').innerText;
            $("input[name='ProvinceId']").val(provinceId);
            $("select[name='OrderSummaryTable.customerInfo.WardId']").removeAttr("disabled");
            $.ajax({
                //test
                //url: "/LocPhucJSCDemo/Get-Ward",

                url: urlDemo + "/Get-Ward",
                type: "GET",
                data: {
                    provinceId: provinceId
                },
                success: function (data) {
                    var ddldist = $('#WardId');
                    $("#WardId option").remove();
                    ddldist.append($('<option></option>').val("").html("Chọn Phường/Xã ..."))
                    $.each(data, function (val, text) {
                        ddldist.append($('<option></option>').val(text.Id).html(text.WardName))
                    })
                }
            });
            var grandTotalOrg = $("#grand-total-hidden").text().replace(/,/g, "");
            //var $form = $("form");
            //$.ajax({

            //    url: urlDemo + "Get-shipping-fee",
            //    type: "POST",
            //    data: $form.serialize(),
            //    success: function (data) {
            //        $("#shipping-fee").text(ReplaceNumberWithCommas(data));
            //        var grandtotal = parseInt(data) + parseInt(grandTotalOrg);
            //        $("#grand-total").text(ReplaceNumberWithCommas(grandtotal));
            //        localStorage.setItem("shippingfee", data)
            //    }
            //})
        });
        $("select[name='OrderSummaryTable.customerInfo.WardId']").on("change", function () {
            var wardId = $("#WardId").val();
            var oHiddenWardName = document.querySelector("input[name='WardName']");
            oHiddenWardName.value = document.getElementById('select2-chosen-3').innerText;
            $("input[name='WardId']").val(wardId)
        })

        $("select[name='OrderSummaryTable.customerInfo.PayerCityId']").on("change", function () {
            var cityId = $("#PayerCityId").val();
            var oHiddenCityName = document.querySelector("input[name='PayerCityName']");
            oHiddenCityName.value = document.getElementById('select2-chosen-4').innerText;
            $("input[name='PayerCityId']").val(cityId);
            $("select[name='OrderSummaryTable.customerInfo.PayerProvinceId']").removeAttr("disabled");
            //$("select[name='OrderSummaryTable.customerInfo.ProvinceId'] + .nice-select.from-control-custom.disabled").removeClass("disabled");
            $.ajax({
                //test
                //url: "/LocPhucJSCDemo/Get-Province",

                url: urlDemo + "/Get-Province",
                type: "GET",
                data: {
                    cityId: cityId
                },
                success: function (data) {
                    var ddldist = $('#PayerProvinceId');
                    $("#PayerProvinceId option").remove();
                    $.each(data, function (val, text) {

                        ddldist.append($('<option></option>').val(text.Id).html(text.ProvinceName))
                    })
                }
            })
        });
        $("select[name='OrderSummaryTable.customerInfo.PayerProvinceId']").on("change", function () {
            var provinceId = $("#PayerProvinceId").val();
            var oHiddenProvinceName = document.querySelector("input[name='PayerProvinceName']");
            oHiddenProvinceName.value = document.getElementById('select2-chosen-5').innerText;
            $("input[name='PayerProvinceId']").val(provinceId);
            $("select[name='OrderSummaryTable.customerInfo.PayerWardId']").removeAttr("disabled");
            $.ajax({
                //test
                //url: "/LocPhucJSCDemo/Get-Ward",

                url: urlDemo + "/Get-Ward",
                type: "GET",
                data: {
                    provinceId: provinceId
                },
                success: function (data) {
                    var ddldist = $('#PayerWardId');
                    $("#PayerWardId option").remove();
                    ddldist.append($('<option></option>').val("0").html("Vui lòng chọn..."))
                    $.each(data, function (val, text) {
                        ddldist.append($('<option></option>').val(text.Id).html(text.WardName))
                    })
                }
            });
            var grandTotalOrg = $("#grand-total-hidden").text().replace(/,/g, "");
            //var $form = $("form");
            //$.ajax({

            //    url: urlDemo + "Get-shipping-fee",
            //    type: "POST",
            //    data: $form.serialize(),
            //    success: function (data) {
            //        $("#shipping-fee").text(ReplaceNumberWithCommas(data));
            //        var grandtotal = parseInt(data) + parseInt(grandTotalOrg);
            //        $("#grand-total").text(ReplaceNumberWithCommas(grandtotal));
            //        localStorage.setItem("shippingfee", data)
            //    }
            //})
        });
        $("select[name='OrderSummaryTable.customerInfo.PayerWardId']").on("change", function () {
            var wardId = $("#PayerWardId").val();
            var oHiddenWardName = document.querySelector("input[name='PayerWardName']");
            oHiddenWardName.value = document.getElementById('select2-chosen-6').innerText;
            $("input[name='PayerWardId']").val(wardId)
        })


        var ajaxSubmit = function (event) {
            var $form = $("form");
            $.ajax({

                //test
                //url: "/LocPhucJSCDemo/Insert-user-info",

                url: urlDemo + "/Insert-user-info",
                type: "POST",
                data: $form.serialize(),
                success: function (data) { },
            });
            return utils.stopEvent(event)
        };
        var start = function () {
            activateFilters()
        };
        return {
            start: start
        }
    })();


    function validateTextBox() {
        document.querySelectorAll('.js-error').forEach(function (item) {
            item.innerHTML = "";
        })

        let inputName = document.querySelector('input[name="UserName"]');
        let inputEmail = document.querySelector('input[name="Email"]');
        let inputPhoneNumber = document.querySelector('input[name="PhoneNumber"]');
        let inputAddress = document.querySelector('input[name="AddressReceiver"]');
        let inputReceiverName = document.querySelector('input[name="ReceiverName"]');
        let inputReceiverEmail = document.querySelector('input[name="ReceiverEmail"]');
        let inputReceiverPhone = document.querySelector('input[name="ReceiverPhone"]');
        let selectCityId = document.querySelector('input[name="ReceiverCityId');
        let selectProvinceId = document.querySelector('input[name="ReceiverProvinceId');
        let selectWardId = document.querySelector('input[name="WardId');
        let inputNameOrganize = document.querySelector('input[name="Bill.NameOrganize');
        let inputTaxCode = document.querySelector('input[name="Bill.TaxCode');
        let inputAddressOrganize = document.querySelector('input[name="Bill.AddressOrganize');
        let QTCheck = document.getElementById('QTCheck');
        let VATCheck = document.getElementById('VATCheck');

        let terms = document.querySelector('#terms');
        //let payment = document.querySelector('.js-payment');
        var checkbox = $("input[name='paymentmethod']:checked").val();

        //let checkboxPayment = document.querySelector('')

        if (inputName.value != "") {
            if (inputName.value.length > 0 && inputName.value.length < 50) {
                if (validateName_(inputName.value)) {
                    inputName.closest('.single-input-item').querySelector('.js-error').innerHTML = "";
                } else {
                    inputName.closest('.single-input-item').querySelector('.js-error').innerHTML = "Họ và tên chỉ chứa các chữ cái";
                }
            } else {
                inputName.closest('.single-input-item').querySelector('.js-error').innerHTML = "Độ dài tối đa chỉ có 50 ký tự.";
            }
        } else {
            inputName.closest('.single-input-item').querySelector('.js-error').innerHTML = "Bạn vui lòng nhập họ tên.";
        }

        if (checkbox === undefined) {
            document.querySelector('.js-payment').innerHTML = "Bạn vui lòng phương thức thanh toán.";
        }
        else {
            if (checkbox === "bankQT" || checkbox === "bankND") {
                if (bankCode === "" || bankCode === undefined) {
                    document.querySelector('.js-payment').innerHTML = "Bạn vui lòng chọn ngân hàng.";
                } else {
                    document.querySelector('.js-payment').innerHTML = "";
                }
            }
            document.querySelector('.js-payment').innerHTML = "";
        }


        if (inputPhoneNumber.value != "") {
            if (inputPhoneNumber.value.length > 0 && inputPhoneNumber.value.length < 15) {
                if (validateNumber_(inputPhoneNumber.value)) {
                    document.querySelector('.js-error__phonenumber').innerHTML = "";
                } else {
                    document.querySelector('.js-error__phonenumber').innerHTML = "Số điện thoại chỉ chứa các số 1-9";
                }
            } else {
                document.querySelector('.js-error__phonenumber').innerHTML = "Dộ dài số điện thoại có 15 ký tự.";
            }
        } else {
            document.querySelector('.js-error__phonenumber').innerHTML = "Bạn vui lòng nhập số điện thoại của bạn.";
        }

        if (inputEmail.value.length > 0) {
            if (validateEmail_(inputEmail.value)) {
                document.querySelector('.js-error__email').innerHTML = "";
            } else {
                document.querySelector('.js-error__email').innerHTML = "Định dạng của email không chính xác, bạn vui lòng nhập lại.";
            }
        } else {
            document.querySelector('.js-error__email').innerHTML = "Bạn vui lòng nhập địa chỉ email của bạn.";
        }

        if (inputAddress.value.length > 0) {
            document.querySelector('.js-error__address').innerHTML = "";
        } else {
            document.querySelector('.js-error__address').innerHTML = "Bạn vui lòng nhập địa chỉ của bạn.";
        }

        //Validate khi chọn quà tặng
        if (QTCheck.checked == true) {
            if (inputReceiverName.value.length > 0) {
                document.querySelector('.js-error__nameReceiver').innerHTML = "";
            } else {
                document.querySelector('.js-error__nameReceiver').innerHTML = "Bạn vui lòng nhập tên người nhận.";
            }

            if (inputReceiverPhone.value.length > 0) {
                document.querySelector('.js-error__phoneReceiver').innerHTML = "";
            } else {
                document.querySelector('.js-error__phoneReceiver').innerHTML = "Bạn vui lòng nhập số điện thoại người nhận.";
            }

            if (inputReceiverEmail.value.length > 0) {
                if (validateEmail_(inputReceiverEmail.value)) {
                    document.querySelector('.js-error__receiverEmail').innerHTML = "";
                } else {
                    document.querySelector('.js-error__receiverEmail').innerHTML = "Định dạng của email không chính xác, bạn vui lòng nhập lại.";
                }
            } else {
                document.querySelector('.js-error__receiverEmail').innerHTML = "Bạn vui lòng nhập địa chỉ email của bạn.";
            }
        }

        //Validate khi yêu cầu xuất hóa đơn
        if (VATCheck.checked == true) {
            if (inputNameOrganize.value.length > 0) {
                if (validateName_(inputNameOrganize.value)) {
                    document.querySelector('.js-error__nameOrganize').innerHTML = "";
                } else {
                    document.querySelector('.js-error__nameOrganize').innerHTML = "Tên công ty chỉ chứa các ký tự chữ cái";
                }
            } else {
                document.querySelector('.js-error__nameOrganize').innerHTML = "Bạn vui lòng nhập tên công ty.";
            }

            if (inputTaxCode.value.length > 0) {
                if (validateNumber_(inputTaxCode.value)) {
                    document.querySelector('.js-error__taxCode').innerHTML = "";

                } else {
                    document.querySelector('.js-error__taxCode').innerHTML = "Mã số thuế chỉ chứa các con số từ 0-9";
                }
            } else {
                document.querySelector('.js-error__taxCode').innerHTML = "Bạn vui lòng nhập mã số thuế.";
            }

            if (inputAddressOrganize.value.length > 0) {
                document.querySelector('.js-error__addressOrganize').innerHTML = "";
            } else {
                document.querySelector('.js-error__addressOrganize').innerHTML = "Bạn vui lòng nhập địa chỉ công ty.";
            }
        }

        if (selectCityId != null) {
            if (selectCityId.value == "0" || selectCityId.value == "") {
                document.querySelector('.js-error__cityId').innerHTML = "Bạn vui lòng chọn Tỉnh/thành phố.";
            } else {
                document.querySelector('.js-error__cityId').innerHTML = "";
            }
        }


        if (selectProvinceId != null) {
            if (selectProvinceId.value == "" || selectProvinceId.value == "QH0") {
                document.querySelector('.js-error__provinceId').innerHTML = "Bạn vui lòng chọn Quận/huyện.";
            } else {
                document.querySelector('.js-error__provinceId').innerHTML = "";
            }
        }



        if (terms.checked == true) {
            document.querySelector('.js-error__terms').innerHTML = "";
        } else {
            document.querySelector('.js-error__terms').innerHTML = "Bạn vui lòng xác nhận điều khoản.";
        }



        let validate = true;
        document.querySelectorAll('.js-error').forEach(function (item) {
            if (item.innerHTML !== "" && item.innerHTML !== undefined) {
                validate = false;
            } 
        })
        return validate;
    }


    // Hoàn tất đặt hàng
    $(".btn-dathang").click(function () {
        var checkbox = $("input[name='paymentmethod']:checked").val();
        var mode = "";
        var store = "";
        var typePaid = "";
        var href = "";


        localStorage.clear();
        var flag = validateTextBox();
        if (!flag) {
            return
        }




        //if (isDeliverToDomicile)
        //    mode = "&mode=DeliverToDomicile";
        //else if (isGetInStore) {
        //    mode = "&mode=GetInStore";
        //    // lưu cửa hàng
        //    $.ajax({
        //        type: "GET",
        //        url: urlDemo + 'GetStore',
        //        data: { "storeName": $("#selectStore option:selected").text() },
        //        success: function (responseData) {
        //        }
        //    })
        //}
        //if (isPaymentDirect) {
        //    //test
        //    //window.location.href = "/LocPhucJSCDemo/hoan-tat-dat-hang?typePaid=khi-nhan-hang"
        //    href = urlDemo + "hoan-tat-dat-hang?typePaid=khi-nhan-hang" + mode       
        //} else if (isCreditTransfer50) {

        //    href = urlDemo + "hoan-tat-dat-hang?typePaid=chuyen-khoan-ngan-hang-50" + mode

        //} else if (isCreditTransfer100) {
        //    href = urlDemo + "hoan-tat-dat-hang?typePaid=chuyen-khoan-ngan-hang-100" + mode
        //} else if (isAdvisory) {
        //    href = urlDemo + "hoan-tat-dat-hang?typePaid=nhan-tu-van" + mode
        //}

        // Tạm đóng ngày 1-4-2020
        //if (checkbox == "transfer50") {
        //    href = urlDemo + "/hoan-tat-dat-hang?typePaid=chuyen-khoan-ngan-hang-50" + mode
        //} else if (checkbox == "transfer100") {
        //    href = urlDemo + "/hoan-tat-dat-hang?typePaid=chuyen-khoan-ngan-hang-100" + mode
        //} else {
        //    href = urlDemo + "/hoan-tat-dat-hang?typePaid=nhan-tu-van" + mode
        //}
        //console.log(bankCode);

        //if (checkbox === "advisory") {
        //    href = urlDemo + "/hoan-tat-dat-hang?typePaid=payoo&paymentMethod=payoo";
        //}
        //else if (checkbox === "interior") {
        //    href = urlDemo + `/hoan-tat-dat-hang?typePaid=interior&bankCode=${bankCode}&paymentMethod=interior`;
        //} else if (checkbox === "international") {
        //    href = urlDemo + `/hoan-tat-dat-hang?typePaid=international&bankCode=${bankCode}&paymentMethod=international`;
        //} else {
        //    href = urlDemo + "/hoan-tat-dat-hang?typePaid=chuyen-khoan-ngan-hang-100" + mode;
        //}

        if (checkbox === "cash") {
            href = urlDemo + "/hoan-tat-dat-hang?typePaid=thanh-toan-tien-mat-khi-nhan-hang" + mode;
        } else if (checkbox === "direction") {
            href = urlDemo + "/hoan-tat-dat-hang?typePaid=thanh-toan-tien-mat-tai-cua-hang" + mode;
        } else if (checkbox === "paymentCK") {
            href = urlDemo + "/hoan-tat-dat-hang?typePaid=chuyen-khoan-ngan-hang-100" + mode;
        } else if (checkbox === "bankND") {
            href = urlDemo + `/hoan-tat-dat-hang?typePaid=interior&bankCode=${bankCode}&paymentMethod=interior`;
        } else if (checkbox === "bankQT") {
            href = urlDemo + `/hoan-tat-dat-hang?typePaid=international&bankCode=${bankCode}&paymentMethod=international`;
        }

        var $form = $("form[name='infor']");
        if (href != "") {

            $.ajax({
                //test
                //url: "/LocPhucJSCDemo/Insert-user-info",
                //site 9
                url: urlDemo + "/Insert-user-info",
                type: "POST",
                data: $form.serialize(),
                success: function (data) {
                    window.location.href = href;
                },
            })
        }



        //console.log(checkbox);
    })

    //function validateTextbox() {
    //    //Clear validate
    //    $('.js-error__buyername').empty();
    //    $('.js-error__buyerphone').empty();
    //    $('.js-error__buyeremail').empty();
    //    //
    //    $('.js-error__firstname').empty();
    //    $('.js-error__lastname').empty();
    //    $('.js-error__phonenumber').empty();
    //    $('.js-error__email').empty();
    //    $('.js-error__cityId').empty();
    //    $('.js-error__provinceId').empty();
    //    $('.js-error__address').empty();
    //    $('.js-error__checkbox').empty();
    //    $('.js-error__payerCityId').empty();
    //    $('.js-error__payerProvinceId').empty();
    //    $('.js-error__payerWardId').empty();
    //    $('.js-error__Payment_internationl').empty();

    //    //var sFirstName = $('#FirstName').val();
    //    var sLastName = $('#UserName').val();
    //    var sPhone = $('#PhoneNumber').val();
    //    var sEmail = $('#Email').val();
    //    var sAddress = $("#Address").val();
    //    var sCity = $("input[name='CityId']").val();
    //    var sProvince = $("input[name='ProvinceId']").val();
    //    var sPayerCity = $("input[name='PayerCityId']").val();
    //    var sPayerProvince = $("input[name='PayerProvinceId']").val();
    //    //var sWard = $("#WardId").val();
    //    var sCheckbox = $("#terms").prop('checked');
    //    var sPayerAddress = $('input[name="PayerAddress"]').val();
    //    var invoice = document.getElementById('invoice').checked;
    //    var paymentInternation = document.getElementById('payment-input-hide').value;

    //    //Nếu là payoo không cần chọn
    //    var checkbox = $("input[name='paymentmethod']:checked").val();

    //    //if (invoice == true) {
    //    //    alert("CHECK!");
    //    //}
    //    //else {
    //    //    alert("UNCHECK!");
    //    //}
    //    var flag = !0;
    //    //Thông tin người mua

    //    //End thông tin người mua
    //    //if ($.trim(sFirstName).length == 0) {
    //    //    $('.js-error__firstname').append("<span>Bạn vui lòng nhập họ</span>")
    //    //    flag = !1
    //    //}
    //    //else
    //    //{
    //    //if (sFirstName.length < 26 && validateName(sFirstName)) {
    //    //    $('.js-error__firstname').empty();
    //    //} else {
    //    //    $('.js-error__firstname').append("<span>Bạn vui lòng nhập họ</span>")
    //    //    flag = !1
    //    //}
    //    //}
    //    if ($.trim(sLastName).length == 0) {
    //        $('.js-error__lastname').append("<span>Bạn vui lòng nhập họ tên người nhận</span>")
    //        flag = !1
    //    } else {
    //        if (sLastName.length < 26 && validateName(sLastName)) {
    //            $('.js-error__lastname').empty();
    //        } else {
    //            $('.js-error__lastname').append("<span>Bạn vui lòng nhập họ tên người nhận</span>")
    //            flag = !1
    //        }
    //    }
    //    if (sPhone.length == 0) {
    //        flag = !1;
    //        $('.js-error__phonenumber').append("<span>Bạn vui lòng nhập số điện thoại người nhận</span>")
    //    } else if (sPhone.length < 15) {
    //        $('.js-error__phonenumber').empty();
    //    } else {
    //        $('.js-error__phonenumber').append("<span>Bạn vui lòng nhập số điện thoại người nhận</span>")
    //        flag = !1
    //    }
    //    if ($.trim(sEmail).length == 0) {
    //        $('.js-error__email').append("<span>Bạn vui lòng nhập email người nhận</span>")
    //        flag = !1
    //    } else {
    //        if (validateEmail(sEmail)) {
    //            $('.js-error__email').empty();
    //        } else {
    //            console.log("sai email");
    //            $('.js-error__email').append("<span>Bạn vui lòng nhập email người nhận</span>")
    //            flag = !1
    //        }
    //    }

    //    //Nếu là payoo không cần chọn ngân hàng
    //    if (checkbox == "interior" || checkbox == "international") {
    //        if (paymentInternation == "") {
    //            $('.js-error__Payment_internationl').append("<span>Bạn vui lòng chọn ngân hàng</span>")
    //            flag = !1
    //        } else {
    //            $('.js-error__Payment_internationl').empty();
    //        }
    //    }

    //    if ($.trim(sAddress).length == 0) {
    //        $('.js-error__address').append("<span>Bạn vui lòng nhập địa chỉ</span>")
    //        flag = !1
    //    } else {
    //        $('.js-error__address').empty();
    //    }
    //    if ($.trim(sCity).length == 0) {
    //        $('.js-error__cityId').append("<span>Bạn vui lòng chọn Tỉnh/Thành Phố</span>")
    //        flag = !1
    //    } else {
    //        $('.js-error__cityId').empty();
    //    }
    //    if ($.trim(sProvince).length == 0 || $.trim(sProvince) == "QH0") {
    //        $('.js-error__provinceId').append("<span>Bạn vui lòng chọn Quận/Huyện</span>")
    //        flag = !1
    //    } else {
    //        $('.js-error__provinceId').empty();
    //    }
    //    if (sCheckbox == false) {
    //        $('.js-error__checkbox').append("<span>Bạn vui lòng xác nhận điều khoản</span>")
    //        flag = !1
    //    } else {
    //        $('.js-error__checkbox').empty();
    //    }

    //    if (invoice == true) {
    //        if ($.trim(sPayerCity).length == 0) {
    //            $('.js-error__payerCityId').append("<span>Bạn vui lòng chọn Tỉnh/Thành Phố đơn vị thanh toán</span>")
    //            flag = !1
    //        } else {
    //            $('.js-error__payerCityId').empty();
    //        }

    //        if ($.trim(sPayerProvince).length == 0 || $.trim(sProvince) == "QH0") {
    //            $('.js-error__payerProvinceId').append("<span>Bạn vui lòng chọn Quận/Huyện đơn vị thanh toán</span>")
    //            flag = !1
    //        } else {
    //            $('.js-error__payerProvinceId').empty();
    //        }

    //        if ($.trim(sPayerAddress).length == 0) {
    //            $('.js-error__payerAddress').append("<span>Bạn vui lòng địa chỉ đơn vị thanh toán</span>")
    //            flag = !1
    //        } else {
    //            $('.js-error__payerAddress').empty();
    //        }
    //    }
    //    else {
    //        $('.js-error__payerCityId').empty();
    //        $('.js-error__payerProvinceId').empty();
    //        $('.js-error__payerAddress').empty();
    //    }


    //    return flag
    //}

    //$("#FirstName").on("keyup", function () {
    //    var sFirstName = $('#FirstName').val();
    //    if ($.trim(sFirstName).length > 0 && $.trim(sFirstName).length < 26) {
    //        $('.js-error__firstname').empty();

    //    } else {
    //        $('.js-error__firstname').html("<span>Bạn vui lòng nhập họ</span>");
    //    }
    //    if (!validateName(sName)) {
    //        $('.js-error__firstname').html("<span>Bạn vui lòng nhập họ</span>");
    //    }

    //})

    $("#UserName").on("keyup", function () {
        var UserName = $('#UserName').val();
        if ($.trim(UserName).length > 0 && $.trim(UserName).length < 50) {
            $('.js-error__lastname').empty();

        } else {
            $('.js-error__lastname').html("<span>Bạn vui lòng nhập họ tên người nhận</span>");
        }
        if (!validateName(UserName)) {
            $('.js-error__lastname').html("<span>Bạn vui lòng nhập họ tên người nhận</span>");
        }
    })
    $("#PhoneNumber").on("keyup", function () {
        var sPhoneNumber = $('#PhoneNumber').val();
        if ($.trim(sPhoneNumber).length > 0 && $.trim(sPhoneNumber).length < 15) {
            $('.js-error__phonenumber').empty();
        } else {
            $('.js-error__phonenumber').html("<span>Bạn vui lòng nhập số điện thoại người nhận</span>")
        }
    })
    $("#Email").on("keyup", function () {
        var sEmail = $('#Email').val();
        if ($.trim(sEmail).length > 0) {
            $('.js-error__email').empty();
        } else {
            $('.js-error__email').html("<span>Bạn vui lòng nhập email người nhận</span>")
        }
    })
    $("#Address").on("keyup", function () {
        var sAddress = $('#Address').val();
        if ($.trim(sAddress).length > 0) {
            $('.js-error__address').empty();
        } else {
            $('.js-error__address').html("<span>Bạn vui lòng nhập địa chỉ</span>")
        }
    })
    $("#PayerAddress").on("keyup", function () {
        var sAddress = $('#PayerAddress').val();
        if ($.trim(sAddress).length > 0) {
            $('.js-error__payerAddress').empty();
        } else {
            $('.js-error__payerAddress').html("<span>Bạn vui lòng nhập địa chỉ đơn vị thanh toán</span>")
        }
    })
    $("#CityId").on("change", function () {
        var sCity = $('#CityId').val();
        if ($.trim(sCity).length > 0) {
            $('.js-error__cityId').empty();
        } else {
            $('.js-error__cityId').html("<span>Bạn vui lòng chọn Tỉnh/Thành Phố</span>");
        }
    })
    $("#ProvinceId").on("change", function () {
        var sProvince = $('#ProvinceId').val();
        if ($.trim(sProvince).length > 0) {
            $('.js-error__provinceId').empty();
        } else {
            $('.js-error__provinceId').html("<span>Bạn vui lòng chọn Quận/Huyện</span>");
        }
    })


    $("#PayerCityId").on("change", function () {
        var sProvince = $('#PayerCityId').val();
        if ($.trim(sProvince).length > 0) {
            $('.js-error__payerCityId').empty();
        } else {
            $('.js-error__payerCityId').html("<span>Bạn vui lòng chọn Tỉnh/Thành đơn vị thanh toán</span>");
        }
    })

    $("#PayerProvinceId").on("change", function () {
        var sProvince = $('#PayerProvinceId').val();
        if ($.trim(sProvince).length > 0 && sProvince.trim() != 'QH0') {
            $('.js-error__payerProvinceId').empty();
        } else {
            $('.js-error__payerProvinceId').html("<span>Bạn vui lòng chọn Quận/Huyện đơn vị thanh toán</span>");
        }
    })



    $("#terms").on("change", function () {
        var sCheckbox = $('#terms').prop('checked');
        if (sCheckbox == true) {
            $('.js-error__checkbox').empty();
        } else {
            $('.js-error__checkbox').html("<span>Bạn vui lòng xác nhận điều khoản</span>");
        }
    })

    function validateName(sName) {
        var validate = /^[a-zA-Z  _ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼÊỀỀỂẾưăạảấầẩẫậắằẳẵặẹẻẽêềềểếỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựýỳỵỷỹ]*$/;
        //var validate = /^[a-zA-Z  _ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼÊỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽêềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ]*$/;
        if (validate.test(sName)) {
            return !0
        } else {
            //alert("Có các ký tự đặc biệt (&*#^$...), bạn vui lòng bỏ đi rồi thử lại");
            return !1
        }

    }



    window.addEventListener('popstate', e => {

        var queryString = window.location.href;
        var indexOfPage = queryString.indexOf('?');
        var usp = new URLSearchParams(queryString.substring(indexOfPage));

        var $parent = $("a.product-page").closest(".pagination-box");
        var $li = $parent.find("li");
        var length = $li.length;
        var indexActive = 1;

        if (usp.get('page') != null) {
            indexActive = parseInt(usp.get('page'));
        }



        $li.removeClass("active");
        $li.eq(indexActive).addClass("active");


        if (indexActive > 1) {
            $parent.find("li:first").show();
        }
        // Show nút next
        if (indexActive + 2 <= length) {
            $parent.find("li:last").show();
        }
        // Trang cuối thì ẩn nút đi        
        if (indexActive == 1) {
            $parent.find("li:first").hide();
        }
        // Trang cuối thì ẩn nút đi        
        if (length - indexActive < 3) {
            $parent.find("li:last").hide();
        }

        // Hiển thị số trang +-2 với li đang active

        var routingProductPage = $("li.active").find('a.product-page').attr("href");
        if (routingProductPage != undefined) {
            // Bộ lọc cho sản phẩm khác với bộ lọc cho kim cương rời nên dùng class để phân biệt
            var isDiamond = $("a.product-page").closest(".paginatoin-area").hasClass("diamond-filter");
            var isProductSearch = $("a.product-page").closest(".paginatoin-area").hasClass("product-search");
            if (isDiamond) {
                getDiamond(null, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive, true);
            } else if (isProductSearch) {
                var name = $("a.product-page").closest(".paginatoin-area.product-search").attr("data-search");
                getProductsSearch(name, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive);
            } else {
                showPageNumbers($parent, $li, length, indexActive);
                if (window.innerWidth < 992) {
                    getProductsMobile(routingProductPage)
                } else {

                    getProducts(routingProductPage);
                }
            }
        }


    });

    // Phân trang
    $(".paginatoin-area").on("click", ".pagination-box .product-page", function (e) {
        e.preventDefault();
        var $parent = $(this).closest(".pagination-box");
        var $li = $parent.find("li");
        var length = $li.length;
        $parent.find("li").removeClass("active");
        $(this).closest("li").addClass("active");
        var indexActive = parseInt($(this).text());
       
       

        // Show nút previous
        if (indexActive > 1) {
            $parent.find("li:first").show();
        }
        // Show nút next
        if (indexActive + 2 <= length) {
            $parent.find("li:last").show();
        }
        // Trang cuối thì ẩn nút đi        
        if (indexActive == 1) {
            $parent.find("li:first").hide();
        }
        // Trang cuối thì ẩn nút đi        
        if (length - indexActive < 3) {
            $parent.find("li:last").hide();
        }

        // Hiển thị số trang +-2 với li đang active

        var routingProductPage = $(this).attr("href");
        if (routingProductPage != undefined) {
            // Bộ lọc cho sản phẩm khác với bộ lọc cho kim cương rời nên dùng class để phân biệt
            var isDiamond = $(this).closest(".paginatoin-area").hasClass("diamond-filter");
            var isProductSearch = $(this).closest(".paginatoin-area").hasClass("product-search");
            if (isDiamond) {
                history.pushState(null, null, `?page=${indexActive}`);
                getDiamond(null, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive, true);
            } else if (isProductSearch) {

                var name = $(this).closest(".paginatoin-area.product-search").attr("data-search");
                history.pushState(null, null, `?name=${name}&&page=${indexActive}`);
                getProductsSearch(name, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive);
            } else {
                history.pushState(null, null, `?page=${indexActive}`);
                showPageNumbers($parent, $li, length, indexActive);
                if (window.innerWidth < 992) {
                    getProductsMobile(routingProductPage)
                } else {

                    getProducts(routingProductPage);
                }
            }
        }




    })

   

    // Click khi phân trang
    $(".paginatoin-area ").on("click", ".pagination-box li > a.previous", function (e) {
        e.preventDefault();
        var $parent = $(this).closest(".pagination-box");
        var $li = $parent.find("li");
        var length = $li.length;
        var indexActive = parseInt($parent.find("li.active").text());


        var indexCurrentActive = indexActive - 1;
       
        $li.removeClass("active");
        $li.eq(indexCurrentActive).addClass("active");

        // Show nút next
        if (indexCurrentActive + 2 <= length) {
            $parent.find("li:last").show();
        }

        // Trang cuối thì ẩn nút đi        
        if (indexCurrentActive == 1) {
            $(this).closest("li").hide();
        }

        // Hiển thị số trang +-2 với li đang active
        //showPageNumbers($parent, $li, length, indexCurrentActive);

        var routingProductPage = $parent.find("li").eq(indexCurrentActive).find("a").attr("href");
        if (routingProductPage != undefined) {
            // Bộ lọc cho sản phẩm khác với bộ lọc cho kim cương rời nên dùng class để phân biệt
            var isDiamond = $(this).closest(".paginatoin-area").hasClass("diamond-filter");
            var isProductSearch = $(this).closest(".paginatoin-area").hasClass("product-search");
            if (isDiamond) {
                history.pushState(null, null, `?page=${indexCurrentActive}`);
                getDiamond(null, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive, true);
            } else if (isProductSearch) {
                var name = $(this).closest(".paginatoin-area.product-search").attr("data-search");
                history.pushState(null, null, `?name=${name}&&page=${indexCurrentActive}`);
                getProductsSearch(name, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive);
            }
            else {
                history.pushState(null, null, `?page=${indexCurrentActive}`);
                showPageNumbers($parent, $li, length, indexActive);
                if (window.innerWidth < 992) {
                    getProductsMobile(routingProductPage)
                } else
                    getProducts(routingProductPage);
            }
        }



    })

    $(".paginatoin-area").on("click", ".pagination-box li > a.next", function (e) {
        var $parent = $(this).closest(".pagination-box");
        var $li = $parent.find("li");
        var length = $li.length;
        var indexActive = parseInt($parent.find("li.active").text());

        var indexCurrentActive = indexActive + 1;
       
        $li.removeClass("active");
        $li.eq(indexCurrentActive).addClass("active");

        // Show nút previous
        if (indexCurrentActive > 1) {
            $parent.find("li:first").show();
        }
        // Trang cuối thì ẩn nút đi        
        if (length - indexActive < 4) {
            $(this).closest("li").hide();
        }

        // Hiển thị số trang +-2 với li đang active
        //showPageNumbers($parent, $li, length, indexCurrentActive);

        var routingProductPage = $parent.find("li").eq(indexCurrentActive).find("a").attr("href");
        if (routingProductPage != undefined) {
            // Bộ lọc cho sản phẩm khác với bộ lọc cho kim cương rời nên dùng class để phân biệt
            var isDiamond = $(this).closest(".paginatoin-area").hasClass("diamond-filter");
            var isProductSearch = $(this).closest(".paginatoin-area").hasClass("product-search");
            if (isDiamond) {
                history.pushState(null, null, `?page=${indexCurrentActive}`);
                getDiamond(null, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive, true);

            } else if (isProductSearch) {
                var name = $(this).closest(".paginatoin-area.product-search").attr("data-search");
                history.pushState(null, null, `?name=${name}&&page=${indexCurrentActive}`);
                getProductsSearch(name, routingProductPage);
                showPageNumbers($parent, $li, length, indexActive);
            } else {
                history.pushState(null, null, `?page=${indexCurrentActive}`);
                showPageNumbers($parent, $li, length, indexActive);
                if (window.innerWidth < 992) {
                    getProductsMobile(routingProductPage)
                } else
                    getProducts(routingProductPage);
            }
        }
        e.preventDefault();

    })

    // Hiển thị số trang +-2 với li đang active
    function showPageNumbers($parent, $li, length, indexCurrentActive, isDiamond) {

        if (isDiamond) {
            $('html,body').animate({
                scrollTop: $('.wishlist-main-wrapper .section-bg-color').offset().top - 130
            }, 1500);
        } else {
            $('html,body').animate({
                scrollTop: $('#product-lpj').offset().top - 130
            }, 1500);
        }
        if (indexCurrentActive > 2) {

            $parent.find("li:not(:first, :last)").hide();
            if (length > indexCurrentActive + 3) {
                $li.slice(indexCurrentActive - 2, indexCurrentActive + 3).show();
            } else {
                if (length > indexCurrentActive + 2) {
                    $li.slice(indexCurrentActive - 3, indexCurrentActive + 2).show();

                } else if (length > indexCurrentActive + 1) {
                    if (indexCurrentActive - 4 < 0) {
                        $li.slice(1, 5).show();
                        $parent.find("li:last").hide();
                    } else {
                        $li.slice(indexCurrentActive - 4, indexCurrentActive + 1).show();
                    }
                }
            }

        } else {
            $parent.find("li:not(:first, :last)").hide();
            if (indexCurrentActive == 2) {
                $li.slice(indexCurrentActive - 1, indexCurrentActive + 4).show();
                if (length - indexCurrentActive == 2) {

                    $parent.find("li:last").hide();
                }
            } else if (indexCurrentActive == 1) {
                $li.slice(indexCurrentActive, indexCurrentActive + 5).show();
            }

        }
    }

    $("body").on('change', 'select.nice-select-f', function () {
        var productGroup = $('#filter-productgroup').val();
        console.log(productGroup);
        // do whatever with the value
    });
    $(".product-short .nav-item.dropdown-f").on('click', 'ul.list li', function () {
        var $parent = $(this).closest(".nav-item").find("select").attr("id");

        getProductFilter($parent, $(this).attr("data-value"), null);

    });

    function getDataProductFilter(routingProductPage, jewelryGroup, productGroup, productType, goldType, goldAge, sex, productPrice, isRatingProduct, sortPrice) {
        console.log("HIT");
        $.ajax({
            url: urlDemo + "/productfilter",
            type: "POST",
            data: { routingProductPage: routingProductPage + "/1", jewelryGroup: jewelryGroup == "" ? undefined : jewelryGroup, productGroup: productGroup == "" ? undefined : productGroup, productType: productType == "" ? undefined : productType, goldType: goldType == "" ? undefined : goldType, goldAge: goldAge == "" ? undefined : goldAge, sex: sex == "" ? undefined : sex, productPrice: productPrice, isRatingProduct: isRatingProduct, sortPrice: sortPrice },
            beforeSend: function () {
                $("#preloader").css("display", "block");
            },
            success: function (data) {
                $("#product-lpj .shop-product-wrap.grid-view.mbn-30").html(data);
                var page = $("#filter-productpage").val();
                $(".paginatoin-area.text-center.mb-30").html("");
                if (page > 1) {
                    var stringPage = "";
                    for (var i = 0; i < page; i++) {
                        if (i == 0) {
                            stringPage += `<li class="active"><a class="product-page" href="${routingProductPage}/${i + 1}">${i + 1}</a></li>`
                        } else {
                            stringPage += `<li><a class="product-page" href="${routingProductPage}/${i + 1}">${i + 1}</a></li>`
                        }
                    }
                    $(".paginatoin-area.text-center.mb-30").html(`
                            <ul class="pagination-box">
                                <li><a class="previous" href="#"><i class="pe-7s-angle-left"></i></a></li>                               
                                    ${stringPage}
                                <li><a class="next" href="#"><i class="pe-7s-angle-right"></i></a></li>
                            </ul>              
                        `);
                    showPage();
                }

                $("#preloader").css("display", "none");
            }
        });
    }

    var filterPrice = [0, 2000000, 5000000, 10000000, 20000000, 30000000, 50000000, 60000000];
    function getProductFilter($parent, value, productPrice) {
        var productGroup = $('#filter-productgroup').val()
            , productType = $('#filter-producttype').val()
            , goldAge = $('#filter-goldage').val()
            , goldType = $('#filter-goldtype').val()
            , jewelryGroup = $('#filter-jewelrygroup').val()
            , sex = $('#filter-sex').val()
            , routingProductPage = $("#filter-routingproductpage").val().replace(urlDemo, "");

       

        if (productPrice == null) {
            var onChangePrice = $("#demo_filter").data("ionRangeSlider");
            if (onChangePrice != null) {
                productPrice = [filterPrice[onChangePrice.result.from], filterPrice[onChangePrice.result.to]];
            } else productPrice = undefined;
        } else {
            productPrice = productPrice;
        }
        switch ($parent) {
            case "filter-productgroup":
                productGroup = value;
                break;
            case "filter-producttype":
                productType = value;
                break;
            case "filter-goldage":
                goldAge = value;
                break;
            case "filter-goldtype":
                goldType = value;
                break;
            case "filter-jewelrygroup":
                jewelryGroup = value;
                break;
            case "filter-sex":
                sex = value;
                break;
        }

        if (routingProductPage != null) {
            getDataProductFilter(routingProductPage, jewelryGroup, productGroup, productType, goldType, goldAge, sex, productPrice, false, "NA");
        }
    }
    $("aside.off-filters-wrapper").on("click", ".mobile-filters ul.blog-tags > li a", function (e) {

        $(this).parent().parent().find("a.active").removeClass("active");
        $(this).addClass("active");

        getProductFilterMobile(null, false, "NA");

    })
    $(".off-sortings-wrapper").on("click", ".minicart-button", function () {
        getProductFilterMobile(null);
    })
    function getProductFilterMobile(productPrice) {
        console.log("Hit");
        var productGroup = $("#filter-productgroup-mobile ul.blog-tags a.active").attr("data-value");
        var productType = $("#filter-producttype-mobile ul.blog-tags a.active").attr("data-value");
        var goldAge = $("#filter-goldage-mobile ul.blog-tags a.active").attr("data-value");
        var goldType = $("#filter-goldtype-mobile ul.blog-tags a.active").attr("data-value");;
        var jewelryGroup = $("#filter-jewelrygroup-mobile ul.blog-tags a.active").attr("data-value");
        var sex = $("#filter-sex-mobile ul.blog-tags a.active").attr("data-value");
        var routingProductPage = $("#filter-routingproductpage").val().replace(urlDemo, "");
        var sortPrice = "NA";
        var isRatingProduct = false;
        if ($("#customCheck1").is(":checked")) {
            sortPrice = $("#customCheck1").val();
        } else if ($("#customCheck5").is(":checked")) {
            sortPrice = $("#customCheck5").val();
        }
        if ($("#customCheck3").is(":checked"))
            isRatingProduct = true;

        if (productPrice == null) {
            var onChangePrice = $("#demo_filter1").data("ionRangeSlider");
            if (onChangePrice != null) {
                productPrice = [filterPrice[onChangePrice.result.from], filterPrice[onChangePrice.result.to]];
            } else productPrice = undefined;
        } else {
            productPrice = productPrice;
        }
        getDataProductFilter(routingProductPage, jewelryGroup, productGroup, productType, goldType, goldAge, sex, productPrice, isRatingProduct, sortPrice);

    }
    // Filter
    $("nav.navbar.navbar-expand-lg").on("click", "a.dropdown-item", function (e) {
        e.preventDefault();

        $(this).parent().find("i").remove();
        if (!$(this).hasClass("active-filter")) { // Bỏ check hiện tại

            $(this).parent().find("a.active-filter").removeClass("active-filter");
            $(this).addClass("active-filter");
            $(this).append("<i class='fa fa-check'></i>");
        } else {
            $(this).parent().find("a.active-filter").removeClass("active-filter");
        }
        // Lấy value của các điều kiện

        var $parent = $(this).closest("ul.navbar-nav.mr-auto");
        var productGroup = $parent.find("#filter-productgroup .active-filter input[name='productgroup']").val();
        var productPrice = $parent.find("#filter-productprice .active-filter input[name='productprice']").val();
        var goldAge = $parent.find("#filter-goldage .active-filter input[name='goldage']").val();
        var goldType = $parent.find("#filter-goldtype .active-filter input[name='goldtype']").val();
        var jewelryGroup = $parent.find("#filter-jewelrygroup .active-filter input[name='jewelrygroup']").val();
        var sex = $parent.find("#filter-sex .active-filter input[name='sex']").val();
        var routingProductPage = $("#filter-routingproductpage").val().replace(urlDemo, "");
        if (routingProductPage != null) {

            $.ajax({
                url: urlDemo + "/productfilter",
                type: "POST",
                data: { routingProductPage: routingProductPage + "/1", jewelryGroup: jewelryGroup, productGroup: productGroup, goldType: goldType, goldAge: goldAge, sex: sex, productPrice: productPrice },
                beforeSend: function () {
                    $("#preloader").css("display", "block");
                },
                success: function (data) {
                    $("#product-lpj .shop-product-wrap.grid-view.mbn-30").html(data);
                    var page = $("#filter-productpage").val();
                    $(".paginatoin-area.text-center.mb-30").html("");
                    if (page > 1) {
                        var stringPage = "";
                        for (var i = 0; i < page; i++) {
                            if (i == 0) {
                                stringPage += `<li class="active"><a class="product-page" href="${routingProductPage}/${i + 1}">${i + 1}</a></li>`
                            } else {
                                stringPage += `<li><a class="product-page" href="${routingProductPage}/${i + 1}">${i + 1}</a></li>`
                            }
                        }
                        $(".paginatoin-area.text-center.mb-30").html(`
                            <ul class="pagination-box">
                                <li><a class="previous" href="#"><i class="pe-7s-angle-left"></i></a></li>                               
                                    ${stringPage}
                                <li><a class="next" href="#"><i class="pe-7s-angle-right"></i></a></li>
                            </ul>              
                        `);
                        showPage();
                    }

                    $("#preloader").css("display", "none");
                }
            });
        }
    })



    function showPage() {
        var $this = $(".paginatoin-area .pagination-box");
        var indexActive = $this.find("li.active").index();
        $this.find("li:not(:last)").hide();
        $this.find("li").slice(indexActive, indexActive + 5).show();
    }

    // Ajax lấy dữ liệu cho trang tìm kiếm
    function getProductsSearch(name, routingProductPage) {
        // Dùng cho site test

        if (routingProductPage != "") {
            $.ajax({
                url: urlDemo + "/search",
                type: "POST",
                data: { name: name, page: routingProductPage },
                success: function (data) {
                    $("#product-lpj .shop-product-wrap.grid-view.mbn-30").html(data);
                }
            });

        }
    }

    // Đăng ký nhận bản tin
    $("footer .newsletter-wrapper").on("click", ".newsletter-inner .news-btn", function (e) {

        var email = $(this).closest(".newsletter-inner").find(".news-field").val();

        $("#alert-registernews.alert").removeClass('alert-danger');
        $("#alert-registernews.alert").removeClass('alert-info');
        if (email != "") {
            $.ajax({
                url: urlDemo + "/dang-ky-nhan-ban-tin",
                type: "POST",
                data: { EMAIL: email },
                beforeSend: function () {
                    $("#preloader").css("display", "block");
                },
                success: function (response) {
                    $("#preloader").css("display", "none");
                    if (response == "Đăng ký nhận bản tin thành công") {
                        $("#alert-registernews.alert").addClass('alert-info');
                    } else {
                        $("#alert-registernews.alert").addClass('alert-danger');
                    }
                    $("#alert-registernews.alert").text(response);
                    $('#alert-registernews.alert').addClass('active');
                    setTimeout(function () {
                        $('#alert-registernews.alert').removeClass('active');
                    }, 2000);
                }
            });
        }
    })


    // Thêm sản phẩm yêu thích
    $("form i.pe-7s-like").click(function (e) {
        e.preventDefault();
        var sku = $(this).closest('form').find('#sku').val();
        if (sku != "" && sku != null) {
            $("#alert-registernews.alert").removeClass('alert-danger');
            $("#alert-registernews.alert").removeClass('alert-info');
            $.ajax({
                url: urlDemo + "/them-san-pham-yeu-thich",
                type: "POST",
                data: { sku: sku },
                beforeSend: function () {
                    $("#preloader").css("display", "block");
                },
                success: function (response) {
                    $("#preloader").css("display", "none");
                    if (response == "True") {
                        $("#alert-registernews.alert").addClass('alert-info');
                        var countFavoriteProduct = $("header .header-right .header-configure-area .pe-7s-like + .notification").text();
                        $("header .header-right .header-configure-area .pe-7s-like + .notification").text(parseInt(countFavoriteProduct) + 1);
                        response = "Cám ơn bạn đã yêu thích sản phẩm";
                    } else if (response == "False") {
                        $("#alert-registernews.alert").addClass('alert-danger');
                        response = "Bạn đã yêu thích sản phẩm này rồi";
                    } else {
                        $("#alert-registernews.alert").addClass('alert-danger');
                        response = "Vui lòng đăng nhập để thêm sản phẩm yêu thích";
                    }
                    $("#alert-registernews.alert").text(response);
                    $('#alert-registernews.alert').addClass('active');
                    setTimeout(function () {
                        $('#alert-registernews.alert').removeClass('active');
                    }, 2000);
                }
            });
        }
    });

    // Xóa sản phẩm yêu thích
    $("#favoriteproduct").on("click", ".delete-favoriteproduct", function (e) {
        e.preventDefault();
        var $parentTr = $(this).closest("tr");
        var $this = $(this);
        var sku = $this.attr("data-sku");

        if (sku != "" && sku != null) {
            $("#alert-registernews.alert").removeClass('alert-danger');
            $("#alert-registernews.alert").removeClass('alert-info');
            $.ajax({
                url: urlDemo + "/xoa-san-pham-yeu-thich",
                type: "POST",
                data: { sku: sku },
                beforeSend: function () {
                    $("#preloader").css("display", "block");
                },
                success: function (response) {
                    $("#preloader").css("display", "none");
                    if (response == "True") {
                        $("#alert-registernews.alert").addClass('alert-info');
                        var countFavoriteProduct = $("header .header-right .header-configure-area .pe-7s-like + .notification").text();
                        $("header .header-right .header-configure-area .pe-7s-like + .notification").text(parseInt(countFavoriteProduct) - 1);
                        $parentTr.remove();
                        response = "Xóa thành công";
                    } else {
                        $("#alert-registernews.alert").addClass('alert-danger');
                        response = "Có lỗi xảy ra vui lòng thử lại";
                    }
                    $("#alert-registernews.alert").text(response);
                    $('#alert-registernews.alert').addClass('active');
                    setTimeout(function () {
                        $('#alert-registernews.alert').removeClass('active');
                    }, 2000);
                }
            });
        }
    });

    // Ajax lấy dữ liệu khi phân trang
    function getProducts(routingProductPage) {
        // Dùng cho site test
        
        routingProductPage = routingProductPage.replace(urlDemo, "");
        if (routingProductPage.substring(0, 1) != '/') {
            routingProductPage = '/' + routingProductPage;
        }

        var productGroup = $('#filter-productgroup').val()
            , goldAge = $('#filter-goldage').val()
            , productType = $('#filter-producttype').val()
            , goldType = $('#filter-goldtype').val()
            , jewelryGroup = $('#filter-jewelrygroup').val()
            , sex = $('#filter-sex').val()
            , onChangePrice = $("#demo_filter").data("ionRangeSlider")
            , productPrice = undefined;
        if (onChangePrice != null) {
            productPrice = [filterPrice[onChangePrice.result.from], filterPrice[onChangePrice.result.to]];
        }
        else {
            productPrice = [0, 60000000];
        }

        if (routingProductPage != "") {
            $.ajax({
                url: urlDemo + "/productfilter",
                type: "POST",
                data: { routingProductPage: routingProductPage, jewelryGroup: jewelryGroup == "" ? undefined : jewelryGroup, productGroup: productGroup == "" ? undefined : productGroup, productType: productType == "" ? undefined : productType, goldType: goldType == "" ? undefined : goldType, goldAge: goldAge == "" ? undefined : goldAge, sex: sex == "" ? undefined : sex, productPrice: productPrice, isRatingProduct: false, sortPrice: "NA" },
                beforeSend: function () {
                    $("#preloader").css("display", "block");
                },
                success: function (data) {
                    $("#product-lpj .shop-product-wrap.grid-view.mbn-30").html(data);
                    $("#preloader").css("display", "none");
                }
            });

        }
    }
    function getProductsMobile(routingProductPage) {
        // Dùng cho site test
        routingProductPage = routingProductPage.replace(urlDemo, "");
        if (routingProductPage.substring(0, 1) != '/') {
            routingProductPage = '/' + routingProductPage;
        }

        var productGroup = $("#filter-productgroup-mobile ul.blog-tags a.active").attr("data-value");
        var productType = $("#filter-producttype-mobile ul.blog-tags a.active").attr("data-value");
        var goldAge = $("#filter-goldage-mobile ul.blog-tags a.active").attr("data-value");
        var goldType = $("#filter-goldtype-mobile ul.blog-tags a.active").attr("data-value");
        var jewelryGroup = $("#filter-jewelrygroup-mobile .ul.blog-tags a.active").attr("data-value");
        var sex = $("#filter-sex-mobile ul.blog-tags a.active").attr("data-value");
        var onChangePrice = $("#demo_filter1").data("ionRangeSlider");
        var productPrice = undefined;
        if (onChangePrice != null) {
            productPrice = [filterPrice[onChangePrice.result.from], filterPrice[onChangePrice.result.to]];
        }
        else {
            productPrice = [0, 60000000];
        }

        var sortPrice = "NA";
        var isRatingProduct = false;
        if ($("#customCheck1").is(":checked")) {
            sortPrice = $("#customCheck1").val();
        } else if ($("#customCheck5").is(":checked")) {
            sortPrice = $("#customCheck5").val();
        }
        if ($("#customCheck3").is(":checked"))
            isRatingProduct = true;

        if (routingProductPage != "") {
            $.ajax({
                url: urlDemo + "/productfilter",
                type: "POST",
                data: { routingProductPage: routingProductPage, jewelryGroup: jewelryGroup == "" ? undefined : jewelryGroup, productGroup: productGroup == "" ? undefined : productGroup, productType: productType == "" ? undefined : productType, goldType: goldType == "" ? undefined : goldType, goldAge: goldAge == "" ? undefined : goldAge, sex: sex == "" ? undefined : sex, productPrice: productPrice, isRatingProduct: isRatingProduct, sortPrice: sortPrice },
                beforeSend: function () {
                    $("#preloader").css("display", "block");
                },
                success: function (data) {
                    $("#product-lpj .shop-product-wrap.grid-view.mbn-30").html(data);
                    $("#preloader").css("display", "none");
                }
            });

        }
    }

    //if (screen.width >= 992) {
    //    $("img.lazy").lazyload({
    //        effect: "fadeIn",
    //        threshold: 400
    //    });
    //} else {
    //    $("img.lazy").lazyload(

    //    );
    //}

    //$("img.lazyload-slider").lazyload();
    //if (screen.width >= 992) {
    //    $("img.lazyload").lazyload({
    //        effect: "fadeIn",
    //        threshold: 400
    //    });
    //} else {
    //    $("img.lazyload").lazyload(
    //    );
    //}


    //$("img.lazy-category").lazyload({
    //    effect: "fadeIn",
    //    threshold: 1000
    //});
    //$("img.lazy-luxury").lazyload({
    //    effect: "fadeIn",
    //    threshold: 500
    //});

    //$(function () {
    //    $('img.lazy').lazy({
    //        effect: "fadeIn",
    //        effectTime: 2000,
    //        threshold: 0
    //    });
    //});

    //$(function () {
    //    $('img.lazyload').lazy({
    //        effect: "fadeIn",
    //        effectTime: 2000,
    //        threshold: 0
    //    });
    //});

    //$(function () {
    //    $('img.lazyloaded').lazy({
    //        effect: "fadeIn",
    //        effectTime: 2000,
    //        threshold: 0
    //    });
    //});
    

    $("body").on("click", "#advisory", function (e) {

        e.preventDefault();
        //console.log("acd");
        var sku = $(this).closest("form").find("input[name='sku']").val();
        //console.log(sku);
        $("#advisory_form").css('display', 'block');
        $("#close_advisory_form").click(function (e) {
            e.preventDefault();
            $("#advisory_form").css('display', 'none');
        });

        
        $("#form_advisory").validate({
            errorLabelContainer: "#error-note",
            wrapper: "li",
            onfocusout: function (element, event) {
                this.element(element);
            },
            rules: {
                fullname: "required",
                phone: {
                    //matches: "[0-9\-\(\)\s]+",
                    minlength: 10,
                    required: true
                },
            },
            messages: {
                fullname: "Vui lòng nhập họ và tên",
                phone: {
                    required: "Vui lòng nhập số điện thoại",
                    //matches: "Chỉ được nhập số",
                    minlength: "Độ dài ít nhất 10"
                }
            }
        })

        //$("#form_advisory").validate({
        //    rules: {
        //        "fullname": "required",
        //        "phone": {
        //            matches: "[0-9\-\(\)\s]+",
        //            minlength: 10,
        //            required: true
        //        },
        //    },
        //    messages: {
        //        "fullname": "Vui lòng nhập họ và tên",
        //        "phone": {
        //            required: "Vui lòng nhập số điện thoại",
        //            matches: "Chỉ được nhập số",
        //            minlength: "Độ dài ít nhất 10"
        //        }
        //    }
        //})

        //On focusout validation
        //$("#form_advisory input[name='fullname']").focusout(function () {
        //    if ($("#form_advisory input[name='fullname']").val() == "") {
        //        alert("Họ và tên không được để trống!");
        //        return;
        //    }
        //});

        //$("#form_advisory input[name='phone']").focusout(function () {
        //    if ($("#form_advisory input[name='phone']").val() == "") {
        //        alert("Số điện thoại không được để trống!");
        //        return;
        //    }
        //    if (!($("#form_advisory input[name='phone']").val().match(/^\d{10}$/))) {
        //        alert("Nhập số điện thoại sai!");
        //        return;
        //    }
        //});

        $("#submit_advisory_form").click(function (e) {
            e.preventDefault();
            //if ($("#form_advisory input[name='fullname']").val() == "") {
            //    alert("Họ và tên không được để trống!");
            //    return;
            //}
            //if ($("#form_advisory input[name='phone']").val() == "") {
            //    alert("Số điện thoại không được để trống!");
            //    return;
            //}
            //if (!($("#form_advisory input[name='phone']").val().match(/^\d{10}$/))) {
            //    alert("Nhập số điện thoại sai!");
            //    return;
            //}
            //if ($("#form_advisory input[name='phone']").val().match(/^\d{10}$/) && $("#form_advisory input[name='fullname']").val() != "") {
            if ($("#form_advisory").valid()) {
                $.ajax({
                    url: urlDemo + "/advisory",
                    type: "POST",
                    data: {
                        Fullname: $("#form_advisory input[name='fullname']").val(),
                        Phone: $("#form_advisory input[name='phone']").val(),
                        Email: $("#form_advisory input[name='email']").val(),
                        Content: $("#form_advisory input[name='content']").val(),
                        ProductSku: sku
                    },
                    success: function (response) {
                        if (response == true) {
                            alert("Đăng ký tư vấn thành công!");
                            $("#form_advisory input[name='fullname']").val("");
                            $("#form_advisory input[name='phone']").val("");
                            $("#form_advisory input[name='email']").val("");
                            $("#form_advisory input[name='content']").val("");
                            sku = "";
                            $("#advisory_form").css('display', 'none');
                        } else {
                            alert("Đăng ký tư vấn không thành công!");
                        }
                    }
                });
            }
        });
        

    })

    $("body").on("click", ".modal-quickview-favorite", function () {
        //var sku = $(this).closest("form").find("input[name='sku']").val();
        //var sku = $(this).closest("form").find("input[name='sku']").val();
        let oParent = this.parentNode;
        let sSku = oParent.querySelector("td input[name='sku']").value;
        if (sSku != "") {
            $.ajax({
                url: urlDemo + "/quickview",
                type: "POST",
                data: { sku: sSku },
                success: function (data) {

                    //$('.product-large-slider-quickview').slick({
                    //    fade: true,
                    //    arrows: false,
                    //    asNavFor: '.pro-nav.nav-quickview'
                    //});


                    //// product details slider nav active
                    //$('.pro-nav.nav-quickview').slick({
                    //    slidesToShow: 5,
                    //    asNavFor: '.product-large-slider-quickview',

                    //    centerPadding: 0,
                    //    focusOnSelect: true,
                    //    prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                    //    nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                    //    responsive: [{
                    //        breakpoint: 576,
                    //        settings: {
                    //            slidesToShow: 3,
                    //        }
                    //    }]
                    //});
                }
            });

        }
    });

    $("body").on("click", ".modal-quickview-favorite", function () {
        //var sku = $(this).closest("form").find("input[name='sku']").val();
        //var sku = $(this).closest("form").find("input[name='sku']").val();
        let oParent = this.parentNode;
        let sSku = oParent.querySelector("td input[name='sku']").value;
        if (sSku != "") {
            $.ajax({
                url: urlDemo + "/quickview",
                type: "POST",
                data: { sku: sSku },
                success: function (data) {
                    //(data.ProductImageDTO.length < 3) ? $("#quick_view .product-details-inner").addClass("lower-than-three") : (data.ProductImageDTO.length < 5 ? $("#quick_view .product-details-inner").addClass("lower-than-five") : "");
                    if (data.ProductImageDTO.length < 3) {
                        $("#quick_view .product-details-inner").addClass("lower-than-three")
                        $("#quick_view .product-details-inner").removeClass("lower-than-five");
                    } else if (data.ProductImageDTO.length < 5) {
                        $("#quick_view .product-details-inner").addClass("lower-than-five")
                        $("#quick_view .product-details-inner").removeClass("lower-than-three");
                    } else {
                        $("#quick_view .product-details-inner").addClass("");
                        $("#quick_view .product-details-inner").removeClass("lower-than-three");
                        $("#quick_view .product-details-inner").removeClass("lower-than-five");

                    }

                    //data.ProductImageDTO.length < 5 ? $("#quick_view .product-details-inner").addClass("lower-than-five") : "";
                    console.log("Testing below");
                    console.log(data.ProductImageDTO.length);
                    $("#quick_view .col-lg-5").html("");
                    $("#quick_view .col-lg-5").append(`
                        <div class='product-large-slider-quickview'>

                            ${data.ProductImage01 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage02 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage03 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage04 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage05 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}
                            <div class="pro-large-img embed-responsive embed-responsive-1by1">
                                ${data.VideoUrl != null ? `<iframe id="player" class="embed-responsive-item" src="${data.VideoUrl}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>` : `<iframe id="player" class="embed-responsive-item" src="https://www.youtube.com/embed/TXOCd5H8YDQ?version=3&loop=1&playlist=TXOCd5H8YDQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`}
                            </div>
                        </div>
                        <div class='pro-nav slick-row-10 slick-arrow-style nav-quickview'>
                            ${data.ProductImage01 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage02 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage03 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage04 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage05 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}
                            <div id="play" class="pro-nav-thumb">
                                <img src="${urlDemo}/Content/assets/img/icon/PlayButton_2.jpg" alt="product-details" />
                            </div>
                        </div>
                    `);
                    var routing = `${urlDemo}/trang-suc-vang/${data.JewelryGroupRouting}/${data.BOF_ProductGroupRouting}/${data.BOF_ProductTypeRouting}/${data.ProductRouting}`;
                    $("#quick_view input[name='id']").val(data.Oid);
                    $("#quick_view input[name='sku']").val(data.Sku);
                    $("#quick_view input[name='routing']").val(routing);
                    $("#quick_view .manufacturer-name a").attr("href", routing).text(data.Id);
                    $("#quick_view .product-details-des > a").attr("href", routing);
                    $("#quick_view h3.product-name").text(data.ProductName);
                    $("#quick_view .product-rating").text(data.Review);
                    $("#quick_view .price-regular").text(parseInt(data.ProductPrice, 10).toLocaleString("en-US").replace(/,/g, "."));



                    //$("#quick_view form").html("");
                    //$("#quick_view form").html(data)
                    // Data countdown active js
                    //$('[data-countdown]').each(function () {
                    //    var $this = $(this),
                    //        finalDate = $(this).data('countdown');
                    //    $this.countdown(finalDate, function (event) {
                    //        $this.html(event.strftime('<div class="single-countdown"><span class="single-countdown__time">%D</span><span class="single-countdown__text">Ngày</span></div><div class="single-countdown"><span class="single-countdown__time">%H</span><span class="single-countdown__text">Giờ</span></div><div class="single-countdown"><span class="single-countdown__time">%M</span><span class="single-countdown__text">Phút</span></div><div class="single-countdown"><span class="single-countdown__time">%S</span><span class="single-countdown__text">Giây</span></div>'));
                    //    });
                    //});

                    //rating 5 star


                    // quantity change js
                    //$('.pro-qty').prepend('<span class="dec qtybtn">-</span>');
                    //$('.pro-qty').append('<span class="inc qtybtn">+</span>');


                    // prodct details slider active
                    $('.product-large-slider-quickview').slick({
                        fade: true,
                        arrows: false,
                        asNavFor: '.pro-nav.nav-quickview'
                    });


                    // product details slider nav active
                    $('.pro-nav.nav-quickview').slick({
                        slidesToShow: 5,
                        asNavFor: '.product-large-slider-quickview',

                        centerPadding: 0,
                        focusOnSelect: true,
                        prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                        nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                        responsive: [{
                            breakpoint: 576,
                            settings: {
                                slidesToShow: 3,
                            }
                        }]
                    });
                }
            });

        }
    });

    $("body").on("click", ".modal-quickview", function () {
        var sku = $(this).closest("form").find("input[name='sku']").val();
        if (sku != "") {

            $.ajax({
                url: urlDemo + "/quickview",
                type: "POST",
                data: { sku: sku },
                success: function (data) {
                    //(data.ProductImageDTO.length < 3) ? $("#quick_view .product-details-inner").addClass("lower-than-three") : (data.ProductImageDTO.length < 5 ? $("#quick_view .product-details-inner").addClass("lower-than-five") : "");
                    if (data.ProductImageDTO.length < 3) {
                        $("#quick_view .product-details-inner").addClass("lower-than-three")
                        $("#quick_view .product-details-inner").removeClass("lower-than-five");
                    } else if (data.ProductImageDTO.length < 5) {
                        $("#quick_view .product-details-inner").addClass("lower-than-five")
                        $("#quick_view .product-details-inner").removeClass("lower-than-three");
                    } else {
                        $("#quick_view .product-details-inner").addClass("");
                        $("#quick_view .product-details-inner").removeClass("lower-than-three");
                        $("#quick_view .product-details-inner").removeClass("lower-than-five");
                    }

                    //data.ProductImageDTO.length < 5 ? $("#quick_view .product-details-inner").addClass("lower-than-five") : "";
                    console.log("Testing below");
                    console.log(data);
                    if (data.Promotion != null) {
                        $("#quick_view .col-lg-7 .offer-text").show();
                        $("#quick_view .col-lg-7 .product-countdown").show();
                        $("#quick_view .col-lg-7 .price-old").show();
                        $("#quick_view .col-lg-7 .price-regular").text(parseInt(data.Promotion.PromotionPrice, 10).toLocaleString("en-US").replace(/,/g, "."));
                        $("#quick_view .col-lg-7 .price-old").text(parseInt(data.ProductPrice, 10).toLocaleString("en-US").replace(/,/g, "."));
                        activeCountdown($('#quick_view [data-countdown]'), data.Promotion.ToDate);
                    } else {
                        $("#quick_view .col-lg-7 .price-old").hide();
                        $("#quick_view .col-lg-7 .offer-text").hide();
                        $("#quick_view .col-lg-7 .product-countdown").hide();
                        $("#quick_view .col-lg-7 .price-regular").text(parseInt(data.ProductPrice, 10).toLocaleString("en-US").replace(/,/g, "."));
                    }
                    $("#quick_view .col-lg-5").html("");
                    $("#quick_view .col-lg-5").append(`
                        <div class='product-large-slider-quickview'>

                            ${data.ProductImage01 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage02 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage03 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage04 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage05 != null ? `<div class='pro-large-img img-zoom'><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}
                            <div class="pro-large-img embed-responsive embed-responsive-1by1">
                                ${data.VideoUrl != null ? `<iframe id="player" class="embed-responsive-item" src="${data.VideoUrl}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>` : `<iframe id="player" class="embed-responsive-item" src="https://www.youtube.com/embed/TXOCd5H8YDQ?version=3&loop=1&playlist=TXOCd5H8YDQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`}
                            </div>
                        </div>
                        <div class='pro-nav slick-row-10 slick-arrow-style nav-quickview'>
                            ${data.ProductImage01 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage02 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage03 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage04 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}
                            ${data.ProductImage05 != null ? `<div class='pro-nav-thumb'><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}
                            <div id="play" class="pro-nav-thumb">
                                <img src="${urlDemo}/Content/assets/img/icon/PlayButton_2.jpg" alt="product-details" />
                            </div>
                        </div>
                    `);
                    var routing = `${urlDemo}/trang-suc-vang/${data.JewelryGroupRouting}/${data.BOF_ProductGroupRouting}/${data.BOF_ProductTypeRouting}/${data.ProductRouting}`;
                    $("#quick_view input[name='id']").val(data.Oid);
                    $("#quick_view input[name='sku']").val(data.Sku);
                    $("#quick_view input[name='routing']").val(routing);
                    $("#quick_view .manufacturer-name a").attr("href", routing).text(data.Id);
                    $("#quick_view .product-details-des > a").attr("href", routing);
                    $("#quick_view h3.product-name").text(data.ProductName);
                    $("#quick_view .product-rating").text(data.Review);


                    //Lấy dữ liệu size của sản phẩm và add vào modal
                   $("#quick_view select.nice-select").append(`<option>${data.Ni}</option>`);
                    $("#quick_view div.nice-select ul.list").append(`<li data-value="${data.Ni}" class="option">${data.Ni}</li>`);


                    //$("#quick_view form").html("");
                    //$("#quick_view form").html(data)
                    // Data countdown active js
                    //$('[data-countdown]').each(function () {
                    //    var $this = $(this),
                    //        finalDate = $(this).data('countdown');
                    //    $this.countdown(finalDate, function (event) {
                    //        $this.html(event.strftime('<div class="single-countdown"><span class="single-countdown__time">%D</span><span class="single-countdown__text">Ngày</span></div><div class="single-countdown"><span class="single-countdown__time">%H</span><span class="single-countdown__text">Giờ</span></div><div class="single-countdown"><span class="single-countdown__time">%M</span><span class="single-countdown__text">Phút</span></div><div class="single-countdown"><span class="single-countdown__time">%S</span><span class="single-countdown__text">Giây</span></div>'));
                    //    });
                    //});

                    //rating 5 star


                    // quantity change js
                    //$('.pro-qty').prepend('<span class="dec qtybtn">-</span>');
                    //$('.pro-qty').append('<span class="inc qtybtn">+</span>');


                    // prodct details slider active
                    //$('.product-large-slider-quickview').slick({
                    //    fade: true,
                    //    arrows: false,
                    //    asNavFor: '.pro-nav.nav-quickview'
                    //});

                    // Fix slider add error
                    $('.product-large-slider-quickview').not('.slick-initialized').slick({
                        fade: true,
                        arrows: false,
                        asNavFor: '.pro-nav.nav-quickview'
                    });


                    // product details slider nav active
                    //$('.pro-nav.nav-quickview').slick({
                    //    slidesToShow: 5,
                    //    asNavFor: '.product-large-slider-quickview',

                    //    centerPadding: 0,
                    //    focusOnSelect: true,
                    //    prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                    //    nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                    //    responsive: [{
                    //        breakpoint: 576,
                    //        settings: {
                    //            slidesToShow: 3,
                    //        }
                    //    }]
                    //});

                    //Fix slider add error
                    $('.pro-nav.nav-quickview').not('.slick-initialized').slick({
                        slidesToShow: 5,
                        asNavFor: '.product-large-slider-quickview',

                        centerPadding: 0,
                        focusOnSelect: true,
                        prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                        nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                        responsive: [{
                            breakpoint: 576,
                            settings: {
                                slidesToShow: 3,
                            }
                        }]
                    });
                }
            });

        }
    });





    //$('.qtybtn').on('click', function () {
    //    var $button = $(this);
    //    var oldValue = $button.parent().find('input').val();
    //    if ($button.hasClass('inc')) {
    //        var newVal = parseFloat(oldValue) + 1;
    //    } else {
    //        // Don't allow decrementing below zero

    //        if (oldValue > 1) {
    //            var newVal = parseFloat(oldValue) - 1;
    //        } else {
    //            var newVal = 1;
    //        }
    //    }
    //    $button.parent().find('input').val(newVal);
    //});

    //ko cho phép nhập chữ
    function setInputFilter(textbox, inputFilter) {
        ["input", "keydown", "keyup", "mousedown", "mouseup", "select", "contextmenu", "drop"].forEach(function (event) {
            textbox.addEventListener(event, function () {
                if (inputFilter(this.value)) {
                    this.oldValue = this.value;
                    this.oldSelectionStart = this.selectionStart;
                    this.oldSelectionEnd = this.selectionEnd;
                } else if (this.hasOwnProperty("oldValue")) {
                    this.value = this.oldValue;
                    this.setSelectionRange(this.oldSelectionStart, this.oldSelectionEnd);
                }
            });
        });
    }
    setInputFilter(document.getElementById("count-quantity"), function (value) {
        return /^\d*$/.test(value);
    });


    //Kiểm tra sản phẩm có phải số lượng 0 hay không, nếu đúng không cho đặt hàng
    $(document).ready(function () {
        var isDisable = $('a.disabled');
        //console.log(isDisable);
        if (isDisable.is('a.disabled')) alert("Sản phẩm được chọn không có số lượng nào");
    });

    //Validate số lượng
    //$('input[name="QuantityArray"]').keypress(function (event) {        
    //    if (event.which < 49 || event.which > 59) event.preventDefault();
    //});
    $('input[name="QuantityArray"]').on("keyup", function (event) {
        var value = $(this).val();
        if (!/^[0-9]+$/.test(value) || value == 0) {
            $(this).val(1);
        }
    });


    $("#checkOutAccordion").on("click", "span", function () {
        var classCurrent = $(this).find("i").attr("class");
        $(this).find("i").removeClass();
        if (classCurrent == "pe-7s-plus") {
            $(this).find("i").addClass("fa fa-minus-circle");
        } else {
            $(this).find("i").addClass("pe-7s-plus");
        }
    })

    $(document).ready(function () {
        var i = ['2', '3', '4', '5'];
        i.forEach(function (item) {
            $("#checkOutAccordion" + item).on("click", "span", function () {
                var classCurrent = $(this).find("i").attr("class");
                $(this).find("i").removeClass();
                if (classCurrent == "pe-7s-plus") {
                    $(this).find("i").addClass("fa fa-minus-circle");
                } else {
                    $(this).find("i").addClass("pe-7s-plus");
                }
            });
        });
    });
    //Không cho đặt hàng nếu không có số lượng sản phẩm là 0
    //var quantity = document.getElementById("@quantity").value;
    //if (quantity < 1) {
    //    alert("Sản phẩm được chọn không có số lượng nào");
    //}

    //$(".thangthang").click(function () {
    //    var quantity = $("");
    //});
    //rating 5 star


    function barrating(parent, id) {
        $(id).barrating({
            theme: 'fontawesome-stars-o',
            onSelect: function (value) {
                //if (count_rating < limit_rating) {
                //    alert("Cảm ơn bạn đã đánh giá " + value + " sao!");
                //    count_rating++;
                //} else alert("Bạn đã đánh giá hết 3 lần hãy đợi đến 24h sau để được đánh giá tiếp!");
                var sku = $(parent).find("input[name = 'sku']").val();

                $.ajax({
                    url: urlDemo + "/review",
                    type: "POST",
                    data: { sku: sku, rating: value },
                    success: function (data) {
                        if (data == "True") {
                            var ratingCurrent = $(parent).find(".product-review .product-rating").text();
                            $(parent).find(".product-review .product-rating").text(parseInt(ratingCurrent) + 1);
                            alert("Cảm ơn bạn đã đánh giá " + value + " sao!");
                        } else {
                            alert("Bạn đã đánh giá cho sản phẩm này rồi");
                        }
                    }
                });
                //console.log(limit_rating);
                //console.log(count_rating);
            }
        });
    }

    barrating("form.product-detail", "#barrating");
    barrating("form.quick-view", "#barrating-quickview");
    barrating("form.quick_view_diamond", "#barrating-quickview-diamond");

    //Hiển thị 1 hình ảnh trong trang home category1
    $('.product-banner-carousel1').slick({
        autoplay: true,
        speed: 500,
        arrows: true,
        slidesToShow: 1,
        adaptiveHeight: true,
        prevArrow: '<button type="button" class="slick-prev"><i class="pe-7s-angle-left"></i></button>',
        nextArrow: '<button type="button" class="slick-next"><i class="pe-7s-angle-right"></i></button>',
        responsive: [{
            breakpoint: 992,
            settings: {
                slidesToShow: 1
            }
        },
        {
            breakpoint: 768,
            settings: {
                slidesToShow: 1
            }
        },
        {
            breakpoint: 480,
            settings: {
                slidesToShow: 1
            }
        }]
    });


    //Range filter

    $("#demo_0").ionRangeSlider({
        skin: "big",
        min: 100,
        max: 1000,
        from: 550
    });



    $("#demo_1").ionRangeSlider({
        skin: "square",
        type: "double",
        grid: true,
        min: 0,
        max: 1000,
        from: 200,
        to: 800,
        prefix: "$"
    });



    $("#demo_2").ionRangeSlider({
        skin: "big",
        type: "double",
        grid: true,
        min: -1000,
        max: 1000,
        from: -500,
        to: 500
    });



    $("#demo_3").ionRangeSlider({
        skin: "big",
        type: "double",
        grid: true,
        min: -1000,
        max: 1000,
        from: -500,
        to: 500,
        step: 250
    });



    $("#demo_4").ionRangeSlider({
        skin: "square",
        type: "double",
        grid: false,
        min: 3.6,
        max: 10.2,
        from: 3.6,
        to: 10.2,
        step: 0.1,
        onChange: saveResult
    });



    var custom_values = [0, 10, 100, 1000, 10000, 100000, 1000000];
    var my_from = custom_values.indexOf(10);
    var my_to = custom_values.indexOf(10000);

    var listClarity = ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2", "Liên hệ"];
    var listColor = ["D", "E", "F", "G", "H", "I", "J", "K-M", "N-R", "S-Z", "FANCY"];

    $("#demo_5").ionRangeSlider({
        skin: "square",
        type: "double",
        grid: true,
        from: "FL/IF",
        to: "Liên hệ",
        values: listClarity,
        force_edges: true,
        onChange: saveResult
    });

    function saveResult(data) {

        getDiamond();

    }

    function getDiamond(shape, page = 0) {
        var onChangeMm = $("#demo_4").data("ionRangeSlider");
        var onChangeClarity = $("#demo_5").data("ionRangeSlider");
        var onChangeColor = $("#demo_6").data("ionRangeSlider");
        var listClarityQuery = listClarity.slice(onChangeClarity.result.from, onChangeClarity.result.to + 1);
        var listColorQuery = listColor.slice(onChangeColor.result.from, onChangeColor.result.to + 1);
        var listmm = [onChangeMm.result.from, onChangeMm.result.to];
        if (shape == null) {
            //shape = $(".wishlist-main-wrapper .mb-20.mt-20 .list-shape li.active-shape a").attr("data-shape");
            shape = $(".wishlist-main-wrapper .mb-20.mt-20 .list-shape li.active a").attr("data-shape");

        }

        $.ajax({
            url: urlDemo + "/diamondfilter",
            type: "POST",
            data: { shape: shape, ly: listmm, clarity: listClarityQuery, color: listColorQuery, page: page },
            success: function (data) {
                $(".diamond-desktop .table.table-bordered").html(data);

                $(".section-bg-color.d-lg-none.d-md-block").html(data);

                if (page == 0) {

                    var pageShow = $("#filter-productpage").val();
                    $(".paginatoin-area.text-center.mb-30.diamond-filter").html("");
                    if (pageShow > 1) {
                        var stringPage = "";
                        for (var i = 0; i < pageShow; i++) {
                            if (i == 0) {
                                stringPage += `<li class="active"><a class="product-page" href="${i + 1}">${i + 1}</a></li>`
                            } else {
                                stringPage += `<li><a class="product-page" href="${i + 1}">${i + 1}</a></li>`
                            }
                        }
                        $(".paginatoin-area.text-center.mb-30.diamond-filter").html(`
                                <ul class="pagination-box">
                                    <li><a class="previous" href="#"><i class="pe-7s-angle-left"></i></a></li>                               
                                        ${stringPage}
                                    <li><a class="next" href="#"><i class="pe-7s-angle-right"></i></a></li>
                                </ul>              
                            `);
                        showPage();
                    }
                }
            }
        });
    }

    $(".wishlist-main-wrapper").on("click", ".mb-20.mt-20 .list-shape li", function (e) {
        e.preventDefault();
        //$(this).parent().find("li").removeClass("active-shape");
        $(this).parent().find("li").removeClass("active");
        $(this).addClass("active");
        var shape = $(this).find("a").attr("data-shape");
        getDiamond(shape);
    })

    $("#demo_6").ionRangeSlider({
        skin: "square",
        type: "double",
        grid: true,
        from: "D",
        to: "FANCY",
        values: listColor,
        force_edges: true,
        onChange: saveResult
    });

    $("#demo_filter").ionRangeSlider({
        skin: "square",
        type: "double",
        grid: !0,
        from: "0",
        to: "Tr\u00ean 50",
        values: "0;2 tri\u1ec7u;5 tri\u1ec7u;10 tri\u1ec7u;20 tri\u1ec7u;30 tri\u1ec7u;50 tri\u1ec7u;Tr\u00ean 50".split(";"),
        force_edges: !0,
        onFinish: onChangePrice
    });
    // Lấy giá trị

    function onChangePrice() {
        var onChangePrice = $("#demo_filter").data("ionRangeSlider");
        var productPrice = [filterPrice[onChangePrice.result.from], filterPrice[onChangePrice.result.to]];
        getProductFilter("", "", productPrice);
    }
    function onChangePriceMobile() {
        var onChangePrice = $("#demo_filter1").data("ionRangeSlider");
        var productPrice = [filterPrice[onChangePrice.result.from], filterPrice[onChangePrice.result.to]];
        getProductFilterMobile(productPrice);
    }
    $("#demo_filter1").ionRangeSlider({
        skin: "square",
        type: "double",
        grid: !0,
        from: "0",
        to: "Tr\u00ean 50",
        values: "0;2 tri\u1ec7u;5 tri\u1ec7u;10 tri\u1ec7u;20 tri\u1ec7u;30 tri\u1ec7u;50 tri\u1ec7u;Tr\u00ean 50".split(";"),
        force_edges: !0,
        onFinish: onChangePriceMobile
    });

    var $d7 = $("#demo_7");
    var $d7_buttons = $(".js-btn__d7");
    $d7.ionRangeSlider({
        skin: "big",
        grid: true,
        min: 1000,
        max: 1000000,
        from: 100000,
        step: 1000,
        prettify_enabled: true
    });

    var d7_instance = $d7.data("ionRangeSlider");
    $d7_buttons.on("click", function () {
        var $this = $(this);

        var o = {
            prettify_enabled: true,
            prettify_separator: " "
        };

        var type = $this.data("type");

        o.prettify_separator = type;
        if (!type) o.prettify_enabled = false;

        d7_instance.update(o);

        $this.addClass("--active").siblings().removeClass("--active");
    });



    function my_prettify(n) {
        var num = Math.log2(n);
        return n + " &rarr; " + (+num.toFixed(3));
    }

    $("#demo_8").ionRangeSlider({
        skin: "big",
        grid: true,
        min: 1,
        max: 1024,
        from: 256,
        prettify: my_prettify
    });



    var $d9 = $("#demo_9");
    var $d9_buttons = $(".js-btn__d9");

    $d9.ionRangeSlider({
        skin: "big",
        grid: true,
        min: 0,
        max: 100,
        from: 50,
        step: 5,
        max_postfix: "+",
        prefix: "$"
    });

    var d9_instance = $d9.data("ionRangeSlider");
    $d9_buttons.on("click", function () {
        var $this = $(this);

        var prefix = $this.data("prefix");
        var postfix = $this.data("postfix");

        var o = {
            prefix: prefix || "",
            postfix: postfix || ""
        };

        d9_instance.update(o);

        $this.addClass("--active").siblings().removeClass("--active");
    });



    $("#demo_10").ionRangeSlider({
        skin: "big",
        grid: true,
        min: 0,
        max: 100,
        from: 21,
        max_postfix: "+",
        prefix: "Age: ",
        postfix: " years"
    });



    var $d11 = $("#demo_11");
    var $d11_buttons = $(".js-btn__d11");

    $d11.ionRangeSlider({
        skin: "big",
        type: "double",
        grid: true,
        min: 0,
        max: 100,
        from: 47,
        to: 53,
        prefix: "Weight: ",
        postfix: " million pounds"
    });

    var d11_instance = $d11.data("ionRangeSlider");
    $d11_buttons.on("click", function () {
        var $this = $(this);
        var o = {};
        var v = $this.data("variant");
        var s = $this.data("sep");

        if (v !== undefined) {
            o.decorate_both = !+v;
        }

        if (s !== undefined) {
            o.values_separator = s;
        }

        d11_instance.update(o);

        $this.addClass("--active").siblings().removeClass("--active");
    });



    var $d12 = $("#demo_12");
    var $d12_buttons = $(".js-btn__d12");

    $d12.ionRangeSlider({
        skin: "big",
        type: "double",
        grid: true,
        min: -100000,
        max: 100000,
        from: -100000,
        to: 50000,
        step: 10000
    });

    var d12_instance = $d12.data("ionRangeSlider");
    $d12_buttons.on("click", function () {
        var $this = $(this);
        var v = $this.data("variant");

        var o = {
            grid: true,
            force_edges: false,
            hide_min_max: false,
            hide_from_to: false,
            block: false
        };

        switch (v) {
            case 1:
                o.force_edges = true;
                break;

            case 2:
                o.grid = false;
                break;

            case 3:
                o.hide_min_max = true;
                break;

            case 4:
                o.hide_from_to = true;
                break;

            case 5:
                o.block = true;
                break;

            case 6:
                o.grid = false;
                o.hide_min_max = true;
                o.hide_from_to = true;
                break;
        }

        d12_instance.update(o);

        $this.addClass("--active").siblings().removeClass("--active");
    });

    $('.product-carousel-4_2').on('swipe', function (event, slick, direction) {
        console.log(direction);
        // left
    });



    // Thêm 2 sản phẩm nổi bậc
    var countProducts = 10; // Hiển thị mặc định 10 sản phẩm
    var currentFeatured = 2;
    $('.product-carousel-4_2').on("click", '.slick-next.slick-arrow', function () {
        getFeaturedProduct();
    })

    $('.product-carousel-4_2').on('swipe', function (event, slick, direction) {
        getFeaturedProduct();
    });

    function getFeaturedProduct() {
        var currentSlide = $('.product-carousel-4_2').slick('slickCurrentSlide');
        if (currentSlide == currentFeatured) { // Giới hạn 20 sản phẩm

            $.ajax({
                url: urlDemo + "/featuredproduct",
                type: "POST",
                data: { next: countProducts },
                success: function (data) {
                    countProducts += 2;
                    currentFeatured++;
                    $('.product-carousel-4_2').slick('slickAdd', `
                        ${data}
                    `);
                }
            });
        }
    }

    var currentCate1 = 5, countCate1 = 6, currentCate2 = 2, countCate2 = 6, currentCate3 = 2, countCate3 = 6, currentCate4 = 2, countCate4 = 6, currentCate5 = 2, countCate5 = 6, currentCate6 = 2, countCate6 = 6, currentCate7 = 2, countCate7 = 6;
    function getCategoryProduct(classSlider, currentCate) {
        var currentSlide = $(classSlider).slick('slickCurrentSlide');
        console.log(currentSlide);
        var current = 0;
        var countCate = 0;
        var productCategory;
        switch (currentCate) {
            case "category1":
                current = currentCate1;
                countCate = countCate1;
                productCategory = "HighEndJewelry";
                break;
            case "category2":
                current = currentCate2;
                countCate = countCate2;
                productCategory = "DiamondJewelry";

                break;
            case "category3":
                current = currentCate3;
                countCate = countCate3;
                productCategory = "FashionJewelry";

                break;
            case "category4":
                current = currentCate4;
                countCate = countCate4;
                productCategory = "ColoredStoneJewelry";

                break;
            case "category5":
                current = currentCate5;
                countCate = countCate5;
                productCategory = "PearlJewelry";

                break;
            case "category6":
                current = currentCate6;
                countCate = countCate6;
                productCategory = "WeddingJewelry";
                break;
            case "category7":
                current = currentCate7;
                countCate = countCate7;
                productCategory = "NewJewelry";
                break;
            default:
            // code block
        }
        if (currentSlide == current) {

            $.ajax({
                url: urlDemo + "/categoryproduct",
                type: "POST",
                data: { productSelectCategory: productCategory, next: countCate },
                success: function (data) {
                    switch (currentCate) {
                        case "category1":
                            currentCate1 += 1;
                            countCate1 += 1;
                            break;
                        case "category2":
                            currentCate2 += 1;
                            countCate2 += 2;
                            break;
                        case "category3":
                            currentCate3 += 1;
                            countCate3 += 2;
                            break;
                        case "category4":
                            currentCate4 += 1;
                            countCate4 += 2;
                            break;
                        case "category5":
                            currentCate5 += 1;
                            countCate5 += 2;
                            break;
                        case "category6":
                            currentCate6 += 1;
                            countCate6 += 2;
                            break;
                        case "category7":
                            currentCate7 += 1;
                            countCate7 += 2;
                            break;
                        default:
                        // code block
                    }

                    $(classSlider).slick('slickAdd', `
                        ${data}
                    `);
                }
            });
        }
    }

    $('.product-carousel-2_2').on("click", '.slick-next.slick-arrow', function () {
        var currentCate = $(this).closest(".row.home-category").attr("id");
        var getNameCate = "#" + currentCate + ' .product-carousel-2_2';
    })
    $('.product-banner-carousel1').on("click", '.slick-next.slick-arrow', function () {
        var currentCate = $(this).closest(".row.home-category").attr("id");
        var getNameCate = "#" + currentCate + ' .product-banner-carousel1';

        //getCategoryProduct(getNameCate, currentCate);
    })
    // Cho thiết bị khác desktop
    //$('.product-carousel-2_2').on('afterChange', function (event, slick, currentSlide, nextSlide) {
    //    if (screen.width <= 1024) {
    //        var scroll = $(window).scrollTop();
    //        if (scroll > 400) {
    //            var currentCate = $(this).closest(".row.content-home").attr("id");
    //            var getNameCate = "#" + currentCate + ' .product-carousel-2_2';
    //            getCategoryProduct(getNameCate, currentCate);
    //        }
    //    }
    //});
    $('.product-banner-carousel1').on('swipe', function (event, slick, direction) {
        var currentCate = $(this).closest(".row.home-category").attr("id");
        var getNameCate = "#" + currentCate + ' .product-banner-carousel1';
    });

    $('.product-carousel-2_2').on('swipe', function (event, slick, direction) {
        var currentCate = $(this).closest(".row.content-home").attr("id");
        var getNameCate = "#" + currentCate + ' .product-carousel-2_2';
    });




    //Range filter
    // tooltip active js
    $('[data-toggle="tooltip"]').tooltip();
    // Background Image JS start
    var bgSelector = $(".bg-img");
    bgSelector.each(function (index, elem) {
        var element = $(elem),
            bgSource = element.data('bg');
        element.css('background-image', 'url(' + bgSource + ')');
    });
    // Off Canvas Open close
    $(".mobile-menu-btn").on('click', function () {
        $("body").addClass('fix');
        $(".off-canvas-wrapper").addClass('open');
    });
    $(".btn-close-off-canvas,.off-canvas-overlay").on('click', function () {
        $("body").removeClass('fix');
        $(".off-canvas-wrapper").removeClass('open');
    });
    // Off filters Open close
    $(".product_filters").on('click', function () {
        $("body").addClass('fix');
        $(".off-filters-wrapper").addClass('open');
    });
    $(".btn-close-off-filters,.off-filters-overlay").on('click', function () {
        $("body").removeClass('fix');
        $(".off-filters-wrapper").removeClass('open');
    });
    $(".product_sortings").on("click", function () {
        $("body").addClass("fix");
        $(".off-sortings-wrapper").addClass("open")
    });
    $(".btn-close-off-sortings,.off-sortings-overlay").on("click", function () {
        $("body").removeClass("fix");
        $(".off-sortings-wrapper").removeClass("open")
    });


    // CheckBox mobile
    $('#customCheck1, #customCheck5').change(function () {
        if ($(this).is(":checked")) {
            $(this).attr("id") == 'customCheck1' ? $("#customCheck5").prop("checked", false) : $("#customCheck1").prop("checked", false);
        }
    });


    //window.onload = function () {
    //    const img = document.getElementsByTagName('img');
    //    for (var i = 0; i < img.length; i++) {
    //        img[i].removeAttribute('alt');
    //    }

    //}

    //$('.latest-blog-area button.slick-next.slick-arrow').on('click', function () {
    //    $('.latest-blog-area img.lazyload').lazyload();
    //})

    //$('#myModal').modal('show')


    var arrayErrorMessage = document.getElementsByClassName("field-validation");
    //console.log(arrayErrorMessage);
    //console.log(document.getElementById(csfullName).parentNode)

    for (var i = 0; i < arrayErrorMessage.length; i++) {
        var id = arrayErrorMessage[i].getAttribute("data-valmsg-for");
        document.getElementById(id).style.marginBottom = '0';
        document.getElementById(id).parentNode.style.marginBottom = '7px';
    }

    $("p.edit-address a").click(function () {
        $("#infor-shipping .modal-title").text("Địa chỉ nhận hàng");
        $("#infor-shipping .add-address").show();
        $("#infor-shipping .list-delivery").show();
        $("#infor-shipping .create-address").hide();
        //alert("Clicked");
    });

    $(function () {
        $.fn.limit = function ($n) {
            this.each(function () {
                var allText = $(this).html();
                var tLength = $(this).html().length;
                var startText = allText.slice(0, $n);
                if (tLength >= $n) {
                    $(this).html(startText + '...');
                } else {
                    $(this).html(startText);
                };
            });
            return this;
        }
        $('.limit').limit(90);


    });

    //let oForgotEmail = document.getElementById("forgot-email");

})(jQuery);

let bankCode;
let radioPayment = "bankQT";

const fnValidateEmailForgotPassword = function (e) {
    let object = e.target;
    console.log(object.value);
    let oClosest = object.closest(".container-forgot-password");
    console.log(oClosest);
    let oSpanParent = oClosest.querySelector(".flex-label.col-lg-6.col-md-8.col-10");
    let oSpan = oSpanParent.querySelector("span");
    let node = document.createElement("span");
    if (oSpan != null) {
        if (object.value == "") {
            return false;
        }
        else if (object.value != null) {
            oSpan.parentNode.removeChild(oSpan);
        }
    }
    else if (oSpan == null && object.value == "") {
        node.appendChild(document.createTextNode("Bạn vui lòng nhập địa chỉ."));
        oSpanParent.appendChild(node);
    }
}

const fnSubmitChangePassword = function () {
    //ValidateChangePassword();
    let bValidate = ValidateChangePassword();
    if (bValidate) {
        //document.querySelector("button[name='password-save-btn'").onclick = function () {
        document.getElementById("form-save-password").submit();
        //}
    }
    else {
        console.log("Failed");
    }
}

function ValidateChangePassword() {
    let bValidate = false;
    let oErrorOldPassword = document.getElementsByClassName('js-error_current-pwd')[0];
    let oErrorNewPassword = document.getElementsByClassName('js-error_new-pwd')[0];
    let oErrorConfirmPassowrd = document.getElementsByClassName('js-error_confirm-pwd')[0];


    let oOldPassword = document.getElementById('current-pwd');
    let oNewPassword = document.getElementById('new-pwd');
    let oConfirmPassowrd = document.getElementById('confirm-pwd');


    let sOldPassowrdValue = oOldPassword.value;
    let sNewPasswordValue = oNewPassword.value;
    let sConfirmPassowrdValue = oConfirmPassowrd.value;


    if (sOldPassowrdValue.trim() != "") {
        oErrorOldPassword.innerText = "";
    }
    else {
        oErrorOldPassword.innerText = "Bạn vui lòng nhập mật khẩu cũ";
    }


    if (sNewPasswordValue.trim() != "") {
        if (sNewPasswordValue.trim().length > 5) {
            oErrorNewPassword.innerHTML = "";
        }
        else {
            oErrorNewPassword.innerText = "Mật khẩu không thể ít hơn 6 ký tự";
        }
    }
    else {
        oErrorNewPassword.innerText = "Bạn vui lòng nhập mật khẩu mới";
    }

    let confirmPassword = sNewPasswordValue.localeCompare(sConfirmPassowrdValue);

    if (confirmPassword == 0 && sConfirmPassowrdValue && oNewPassword != "") {
        oErrorConfirmPassowrd.innerText = "";
    }
    else {
        oErrorConfirmPassowrd.innerText = "Xác nhận mật khẩu không khớp. Vui lòng kiểm tra lại";
    }

    if (oErrorConfirmPassowrd.innerText == "" && oErrorNewPassword.innerText == "" && oErrorOldPassword.innerText == "") {
        bValidate = true;
    }
    else {
        bValidate = false;
    }
    return bValidate;
}

function GetNameViaId(id) {
    switch (id) {
        case "current-pwd":
            return "mật khẩu hiện tại";
        case "new-pwd":
            return "mật khẩu mới";
        case "confirm-pwd":
            return "xác nhận mật khẩu";
    }
}

function validateOnKeyPress(e) {
    let oOldPassword = document.getElementById('current-pwd');
    let oNewPassword = document.getElementById('new-pwd');
    let oConfirmPassowrd = document.getElementById('confirm-pwd');

    let oErrorOldPassword = document.getElementsByClassName('js-error_current-pwd')[0];
    let oErrorNewPassword = document.getElementsByClassName('js-error_new-pwd')[0];
    let oErrorConfirmPassowrd = document.getElementsByClassName('js-error_confirm-pwd')[0];


    let oCLoset = e.target.closest(".single-input-item");
    let oSpan = oCLoset.querySelector("span[class*='js-error_'");
    if (e.target != oOldPassword) {
        //console.log("HIT");
        if (e.target.value.trim() != "") {
            if (e.target.value.trim().length > 5) {
                oSpan.innerText = "";
            }
            else {
                oSpan.innerText = "Độ dài của mật khẩu phải lớn hơn 5 ký tự";
            }
        }
        else {
            oSpan.innerText = "Bạn vui lòng nhập " + GetNameViaId(e.target.id);
        }
    }
    else {
        if (oOldPassword.value.trim() != "") {
            oErrorOldPassword.innerHTML = "";
        }
        else {
            oErrorOldPassword.innerHTML = "Bạn vui lòng nhập mật khẩu hiện tại";
        }
    }
}



function fnPopModalMobile() {
    $("#diamond_mobile [data-target='#quick_view_diamond'],#diamond_mobile li:not(#certificate)").click(function (e) {
        //$('body').on("click", "#diamond_mobile ul li",function (e) {
        //alert("HIT");
        let oCloset = e.target.closest('.diamond-mb');
        let sku = oCloset.querySelector('#sku');
        let routing = oCloset.querySelector("input[name='routing']");
        console.log(sku.value);
        //console.log(e);
        if (sku.value != "") {
            $.ajax({
                url: urlDemo + "/quickview",
                type: "POST",
                data: { sku: sku.value },
                success: function (data) {
                    //alert("Success");
                    //alert("Success");
                    $('#color').html(data.Color);
                    $('#pure').html(data.Clarity);
                    $('#size').html(data.SizeDiamond);
                    $('#carat').html(data.Carat);
                    $('#cut').html(data.Cut);
                    $('#flu').html(data.FluoInt);
                    $('#quick_view_diamond #sku').html(data.Sku);
                    //$('#quick_view_diamond .manufacturer-name a').attr("href", routing.value);
                    $('#quick_view_diamond .pro-img-1').remove();
                    $('#quick_view_diamond .pro-img-2').remove();
                    $('#quick_view_diamond .pro-img-3').remove();
                    $('#quick_view_diamond .pro-img-4').remove();
                    $('#quick_view_diamond .pro-img-5').remove();
                    if (data.ProductImageDTO.length < 3) {
                        $("#quick_view_diamond .product-details-inner").addClass("lower-than-three")
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                    } else if (data.ProductImageDTO.length < 5) {
                        $("#quick_view_diamond .product-details-inner").addClass("lower-than-five")
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                    } else {
                        $("#quick_view_diamond .product-details-inner").addClass("");
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                    }
                    $('#quick_view_diamond .col-lg-5').html("");
                    $('#quick_view_diamond .col-lg-5').append(`
                        <div class="product-large-slider-quick-view">
                            ${data.ProductImage01 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                             ${data.ProductImage02 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage03 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage04 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage05 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""} 
                            </div>
                        <div class="pro-nav nav-quick-view slick-row-10 slick-arrow-style">
                            ${data.ProductImage01 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage02 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage03 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage04 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage05 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}  
                            </div>
                            `)
                    $('.product-large-slider-quick-view').slick({
                        fade: true,
                        arrows: false,
                        asNavFor: '.pro-nav.nav-quick-view'
                    });


                    // product details slider nav active
                    $('.pro-nav.nav-quick-view').slick({
                        slidesToShow: 5,
                        asNavFor: '.product-large-slider-quick-view',

                        centerPadding: 0,
                        focusOnSelect: true,
                        prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                        nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                        responsive: [{
                            breakpoint: 576,
                            settings: {
                                slidesToShow: 3,
                            }
                        }]
                    });
                }
            });
        }
    })
}

$("#diamond_mobile [data-target='#quick_view_diamond'],#diamond_mobile li:not(#certificate)").click(function (e) {
    //$('body').on("click", "#diamond_mobile ul li",function (e) {
    //alert("HIT");
    let oCloset = e.target.closest('.diamond-mb');
    let sku = oCloset.querySelector('#sku');
    let routing = oCloset.querySelector("input[name='routing']");
    console.log(sku.value);
    //console.log(e);
    if (sku.value != "") {
        $.ajax({
            url: urlDemo + "/quickview",
            type: "POST",
            data: { sku: sku.value },
            success: function (data) {
                //alert("Success");
                //alert("Success");
                $('#color').html(data.Color);
                $('#pure').html(data.Clarity);
                $('#size').html(data.SizeDiamond);
                $('#carat').html(data.Carat);
                $('#cut').html(data.Cut);
                $('#flu').html(data.FluoInt);
                $('#quick_view_diamond #sku').html(data.Sku);
                //$('#quick_view_diamond .manufacturer-name a').attr("href", routing.value);
                $('#quick_view_diamond .pro-img-1').remove();
                $('#quick_view_diamond .pro-img-2').remove();
                $('#quick_view_diamond .pro-img-3').remove();
                $('#quick_view_diamond .pro-img-4').remove();
                $('#quick_view_diamond .pro-img-5').remove();
                if (data.ProductImageDTO.length < 3) {
                    $("#quick_view_diamond .product-details-inner").addClass("lower-than-three")
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                } else if (data.ProductImageDTO.length < 5) {
                    $("#quick_view_diamond .product-details-inner").addClass("lower-than-five")
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                } else {
                    $("#quick_view_diamond .product-details-inner").addClass("");
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                }
                $('#quick_view_diamond .col-lg-5').html("");
                $('#quick_view_diamond .col-lg-5').append(`
                        <div class="product-large-slider-quick-view">
                            ${data.ProductImage01 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                             ${data.ProductImage02 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage03 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage04 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage05 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""} 
                            </div>
                        <div class="pro-nav nav-quick-view slick-row-10 slick-arrow-style">
                            ${data.ProductImage01 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage02 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage03 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage04 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage05 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}  
                            </div>
                            `)
                $('.product-large-slider-quick-view').slick({
                    fade: true,
                    arrows: false,
                    asNavFor: '.pro-nav.nav-quick-view'
                });
                $("#quick_view_diamond input[name='id']").val(data.Oid);
                $("#quick_view_diamond input[name='sku']").val(data.Sku);
                $("#quick_view_diamond input[name='routing']").val("");
                $("#quick_view_diamond .product-rating").text(data.Review);

                // product details slider nav active
                $('.pro-nav.nav-quick-view').slick({
                    slidesToShow: 5,
                    asNavFor: '.product-large-slider-quick-view',

                    centerPadding: 0,
                    focusOnSelect: true,
                    prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                    nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                    responsive: [{
                        breakpoint: 576,
                        settings: {
                            slidesToShow: 3,
                        }
                    }]
                });
            }
        });
    }
})
//$('.img-2').attr('src', data.ProductImage02)

$(".diamond-desktop [data-target='#quick_view_diamond']").click(function (e) {
    //alert("HIT");
    let test = e.target;
    console.log(test);
    let oCloset = e.target.closest('tbody');
    let sku = oCloset.querySelector('#sku');
    let routing = oCloset.querySelector("#routing");

    console.log(sku.value);
    //console.log(e);
    if (sku.value != "") {
        $.ajax({
            url: urlDemo + "/quickview",
            type: "POST",
            data: { sku: sku.value },
            success: function (data) {
                //alert("Success");
                $('#color').html(data.Color);
                $('#pure').html(data.Clarity);
                $('#size').html(data.SizeDiamond);
                $('#carat').html(data.Carat);
                $('#cut').html(data.Cut);
                $('#flu').html(data.FluoInt);
                $('#name').html(data.ProductName);
                $('#quick_view_diamond #sku').html(data.Sku);
                //$('#quick_view_diamond .manufacturer-name a').attr("href", routing.value);
                $('#quick_view_diamond .pro-img-1').remove();
                $('#quick_view_diamond .pro-img-2').remove();
                $('#quick_view_diamond .pro-img-3').remove();
                $('#quick_view_diamond .pro-img-4').remove();
                $('#quick_view_diamond .pro-img-5').remove();
                if (data.ProductImageDTO.length < 3) {
                    $("#quick_view_diamond .product-details-inner").addClass("lower-than-three")
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                } else if (data.ProductImageDTO.length < 5) {
                    $("#quick_view_diamond .product-details-inner").addClass("lower-than-five")
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                } else {
                    $("#quick_view_diamond .product-details-inner").addClass("");
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                    $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                }
                $('#quick_view_diamond .col-lg-5').html("");
                $('#quick_view_diamond .col-lg-5').append(`
                        <div class="product-large-slider-quick-view">
                            ${data.ProductImage01 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                             ${data.ProductImage02 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage03 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage04 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage05 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""} 
                            </div>
                        <div class="pro-nav nav-quick-view slick-row-10 slick-arrow-style">
                            ${data.ProductImage01 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage02 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage03 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage04 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage05 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}  
                            </div>
                            `)
                $('.product-large-slider-quick-view').slick({
                    fade: true,
                    arrows: false,
                    asNavFor: '.pro-nav.nav-quick-view'
                });
                $("#quick_view_diamond input[name='id']").val(data.Oid);
                $("#quick_view_diamond input[name='sku']").val(data.Sku);
                $("#quick_view_diamond input[name='routing']").val("");
                $("#quick_view_diamond .product-rating").text(data.Review);
                // product details slider nav active
                $('.pro-nav.nav-quick-view').slick({
                    slidesToShow: 5,
                    asNavFor: '.product-large-slider-quick-view',

                    centerPadding: 0,
                    focusOnSelect: true,
                    prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                    nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                    responsive: [{
                        breakpoint: 576,
                        settings: {
                            slidesToShow: 3,
                        }
                    }]
                });
            }
        });
    }
})


function fnPopUpModal() {
    $(".diamond-desktop [data-target='#quick_view_diamond']").click(function (e) {
        //alert("HIT");
        let test = e.target;
        console.log(test);
        let oCloset = e.target.closest('tbody');
        let sku = oCloset.querySelector('#sku');
        let routing = oCloset.querySelector("#routing");

        console.log(sku.value);
        //console.log(e);
        if (sku.value != "") {
            $.ajax({
                url: urlDemo + "/quickview",
                type: "POST",
                data: { sku: sku.value },
                success: function (data) {
                    //alert("Success");
                    $('#color').html(data.Color);
                    $('#pure').html(data.Clarity);
                    $('#size').html(data.SizeDiamond);
                    $('#carat').html(data.Carat);
                    $('#cut').html(data.Cut);
                    $('#flu').html(data.FluoInt);
                    $('#quick_view_diamond #sku').html(data.Sku);
                    //$('#quick_view_diamond .manufacturer-name a').attr("href", routing.value);
                    $('#quick_view_diamond .pro-img-1').remove();
                    $('#quick_view_diamond .pro-img-2').remove();
                    $('#quick_view_diamond .pro-img-3').remove();
                    $('#quick_view_diamond .pro-img-4').remove();
                    $('#quick_view_diamond .pro-img-5').remove();
                    if (data.ProductImageDTO.length < 3) {
                        $("#quick_view_diamond .product-details-inner").addClass("lower-than-three")
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                    } else if (data.ProductImageDTO.length < 5) {
                        $("#quick_view_diamond .product-details-inner").addClass("lower-than-five")
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                    } else {
                        $("#quick_view_diamond .product-details-inner").addClass("");
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
                        $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
                    }
                    $('#quick_view_diamond .col-lg-5').html("");
                    $('#quick_view_diamond .col-lg-5').append(`
                        <div class="product-large-slider-quick-view">
                            ${data.ProductImage01 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                             ${data.ProductImage02 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage03 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage04 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""} 
                             ${data.ProductImage05 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""} 
                            </div>
                        <div class="pro-nav nav-quick-view slick-row-10 slick-arrow-style">
                            ${data.ProductImage01 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage02 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage03 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage04 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}  
                            ${data.ProductImage05 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}  
                            </div>
                            `)
                    $('.product-large-slider-quick-view').slick({
                        fade: true,
                        arrows: false,
                        asNavFor: '.pro-nav.nav-quick-view'
                    });


                    // product details slider nav active
                    $('.pro-nav.nav-quick-view').slick({
                        slidesToShow: 5,
                        asNavFor: '.product-large-slider-quick-view',

                        centerPadding: 0,
                        focusOnSelect: true,
                        prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
                        nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
                        responsive: [{
                            breakpoint: 576,
                            settings: {
                                slidesToShow: 3,
                            }
                        }]
                    });
                }
            });
        }
    })
}

//document.querySelector('#select2-chosen-1').value = localStorage.getItem(cityName);





//let object = document.querySelectorAll("table.table.table-bordered.diamond tr td:not(.pro-9):not(.pro-subtotal) > a, table.table.table-bordered.diamond tr td:not(.pro-9):not(.pro-subtotal) > span");
//object.forEach(function (item) {
//    item.onclick = function (e) {
//        //let test = e.target;
//        //console.log(test);
//        //let oCloset = e.target.closest('tbody');
//        //let sku = oCloset.querySelector('#sku');
//        //let routing = oCloset.querySelector("#routing");

//        //console.log(sku.value);
//        ////console.log(e);
//        //if (sku.value != "") {
//        //    $.ajax({
//        //        url: urlDemo + "/quickview",
//        //        type: "POST",
//        //        data: { sku: sku.value },
//        //        success: function (data) {
//        //            //alert("Success");
//        //            $('#color').html(data.Color);
//        //            $('#pure').html(data.Clarity);
//        //            $('#size').html(data.SizeDiamond);
//        //            $('#carat').html(data.Carat);
//        //            $('#cut').html(data.Cut);
//        //            $('#flu').html(data.FluoInt);
//        //            $('#quick_view_diamond #sku').html(data.Sku);
//        //            //$('#quick_view_diamond .manufacturer-name a').attr("href", routing.value);
//        //            $('#quick_view_diamond .pro-img-1').remove();
//        //            $('#quick_view_diamond .pro-img-2').remove();
//        //            $('#quick_view_diamond .pro-img-3').remove();
//        //            $('#quick_view_diamond .pro-img-4').remove();
//        //            $('#quick_view_diamond .pro-img-5').remove();
//        //            if (data.ProductImageDTO.length < 3) {
//        //                $("#quick_view_diamond .product-details-inner").addClass("lower-than-three")
//        //                $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
//        //            } else if (data.ProductImageDTO.length < 5) {
//        //                $("#quick_view_diamond .product-details-inner").addClass("lower-than-five")
//        //                $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
//        //            } else {
//        //                $("#quick_view_diamond .product-details-inner").addClass("");
//        //                $("#quick_view_diamond .product-details-inner").removeClass("lower-than-three");
//        //                $("#quick_view_diamond .product-details-inner").removeClass("lower-than-five");
//        //            }
//        //            $('#quick_view_diamond .col-lg-5').html("");
//        //            $('#quick_view_diamond .col-lg-5').append(`
//        //                <div class="product-large-slider-quick-view">
//        //                    ${data.ProductImage01 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
//        //                     ${data.ProductImage02 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""} 
//        //                     ${data.ProductImage03 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""} 
//        //                     ${data.ProductImage04 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""} 
//        //                     ${data.ProductImage05 != null ? `<div class="pro-large-img"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""} 
//        //                    </div>
//        //                <div class="pro-nav nav-quick-view slick-row-10 slick-arrow-style">
//        //                    ${data.ProductImage01 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage01}" alt="product-details" /></div>` : ""}  
//        //                    ${data.ProductImage02 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage02}" alt="product-details" /></div>` : ""}  
//        //                    ${data.ProductImage03 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage03}" alt="product-details" /></div>` : ""}  
//        //                    ${data.ProductImage04 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage04}" alt="product-details" /></div>` : ""}  
//        //                    ${data.ProductImage05 != null ? `<div class="pro-nav-thumb"><img src="${urlDemo}/Content/Images${data.ProductImage05}" alt="product-details" /></div>` : ""}  
//        //                    </div>
//        //                    `)
//        //            $('.product-large-slider-quick-view').slick({
//        //                fade: true,
//        //                arrows: false,
//        //                asNavFor: '.pro-nav.nav-quick-view'
//        //            });


//        //            // product details slider nav active
//        //            $('.pro-nav.nav-quick-view').slick({
//        //                slidesToShow: 5,
//        //                asNavFor: '.product-large-slider-quick-view',

//        //                centerPadding: 0,
//        //                focusOnSelect: true,
//        //                prevArrow: '<button type="button" class="slick-prev"><i class="lnr lnr-chevron-left"></i></button>',
//        //                nextArrow: '<button type="button" class="slick-next"><i class="lnr lnr-chevron-right"></i></button>',
//        //                responsive: [{
//        //                    breakpoint: 576,
//        //                    settings: {
//        //                        slidesToShow: 3,
//        //                    }
//        //                }]
//        //            });
//        //        }
//        //    });
//        //}
//    }
//});
//function check

//alert("HELLO");
let promotionInput = document.querySelector(".error_promotion");
let inputPromotionCode = document.querySelector('input[name="promotionCode"]');
if (inputPromotionCode != undefined) {
    inputPromotionCode.onkeyup = function (e) {
        if (this.value == "") {
            promotionInput.innerHTML = "Bạn vui lòng nhập mã khuyến mãi.";
        } else {
            promotionInput.innerHTML = "";
        }
    }
}

let submitPromotion = document.querySelector('.submit-promotion');
submitPromotion == undefined ? undefined : submitPromotion.onclick = function (e) {
    let promotionCode = document.querySelector('input[name="promotionCode"]').value;
    if (promotionCode == "") {
        promotionInput.innerHTML = "Bạn vui lòng nhập mã khuyến mãi.";
    } else {
        let closeDOM = this.closest('.row');
        //console.log(closeDOM);
        let promotionCode = closeDOM.querySelector('input[name="promotionCode"]').value;
        $.ajax({
            url: `${urlDemo}/check-promotion-code`,
            type: 'POST',
            data: {
                promotionCode: promotionCode,
            },
            success: function (response) {
                //alert("Success");
                location.href = urlDemo + "/dat-hang";
            },
        })
        promotionInput.innerHTML = "";

        //this.closest('form').submit();
    }
}

const removeBorderEachItem = function (item) {
    item.style.border = "";
    item.style.transition = "";
}

let paymentMethodDetailND = document.querySelector('.bankND .mt-1.mt-md-0');
paymentMethodDetailND == undefined ? undefined : paymentMethodDetailND.onclick = function (e) {
    //console.log(document.querySelector('.bankND').querySelectorAll('span'));

    //Xóa border cũ
    document.querySelector('.bankND').querySelectorAll('span').forEach(removeBorderEachItem);
    if (e.target.tagName != 'IMG') {
        bankCode = "";
        return true;
    }

    let closestSpan = e.target.closest('span');
    //console.log(closestSpan.getAttribute("bc"));
    if (closestSpan.tagName != "SPAN") {
        bankCode = "";
        return true;
    }
    bankCode = closestSpan.getAttribute("bc");
    closestSpan.style.border = "2px solid #363636";
    closestSpan.style.transition = "0.5s";
}

let paymentMethodDetailQT = document.querySelector('.bankQT .text-center');
paymentMethodDetailQT == undefined ? undefined : paymentMethodDetailQT.onclick = function (e) {
    //console.log(document.querySelector('.bankND').querySelectorAll('span'));

    //Xóa border cũ
    document.querySelector('.bankQT').querySelectorAll('span').forEach(removeBorderEachItem);
    if (e.target.tagName != 'IMG') {
        bankCode = "";
        return true;
    }

    let closestSpan = e.target.closest('span');
    if (closestSpan.tagName != "SPAN") {
        bankCode = "";
        return true;
    }

    bankCode = closestSpan.getAttribute("bc");
    closestSpan.style.border = "2px solid #363636";
    closestSpan.style.transition = "0.5s";
}

let delegateEventPaymentMethod = document.querySelector('.div-mt-20');
delegateEventPaymentMethod == undefined ? undefined : delegateEventPaymentMethod.onclick = function (e) {
    if (e.target.tagName != 'LABEL' && e.target.tagName != 'INPUT')
        //bankCode = "";
        return true;

    let closest = e.target.closest('.custom-control.custom-radio');
    let id = closest.querySelector('input').id;

    if (id != 'directbankQT' && id != 'directbankND') {
        //bankCode = "";
        return true;
    }
    radioPayment = closest.querySelector('input').value;
    bankCode = "";
    id == 'directbankQT' ? document.querySelector('.bankQT').querySelectorAll('span').forEach(removeBorderEachItem) :
        document.querySelector('.bankND').querySelectorAll('span').forEach(removeBorderEachItem);
}

